var fb={db:null,config:{apiKey:"AIzaSyD0LhmulK6Hrn-m-gfhj3XFNUq2OgfEmzg",authDomain:"pogo-63931.firebaseapp.com",databaseURL:"https://pogo-63931.firebaseio.com",storageBucket:"pogo-63931.appspot.com"},start:function(){firebase.initializeApp(this.config),this.db=firebase.database()},onChildAdded:function(t,a){var i=this.db.ref(t);i.on("child_added",function(t){var i=t.val();a(i)})}};fb.start();var pokeapi={urlPrefix:"https://pokeapi.co/api/v2/pokemon/",getData:function(t,a){var i=this.urlPrefix+t;$.getJSON(i,function(t){t.status="ok",a(t)}).fail(function(){var t={weight:null,height:null,types:null,status:"fail"};a(t)})}},map,infoWindow,initMap=function(){map=new google.maps.Map(document.getElementById("map"),{center:{lat:19.725862,lng:-155.06906},zoom:16}),infoWindow=new google.maps.InfoWindow},googleError=function(){document.getElementById("map").innerHTML="<h1>Sorry, Google Maps is unavailable at the moment</h1><p>Please try again later.</p>"},pogosnap={urlPrefix:"https://www.reddit.com/r/PokemonGoSnap/search.json?",params:{restrict_sr:"true",limit:"1",sort:"top"},getData:function(t,a){var i=this,r=i.urlPrefix;r+="q="+t.name,r+="&restrict_sr="+i.params.restrict_sr,r+="&limit="+i.params.limit,r+="&sort="+i.params.sort;$.getJSON(r,function(t){var r=t.data.children[0].data;if(void 0!==r){var e={picture:i.fixUrl(r.url),author:r.author,permalink:"https://www.reddit.com"+r.permalink,status:"ok"};a(e)}else{var o={picture:"#",author:"",permalink:"",status:"noresults"};a(o)}}).fail(function(){var t={picture:"#",author:"",permalink:"",status:"fail"};a(t)})},fixUrl:function(t){var a=t;return t.search("reddituploads")&&(a=t.split("&amp;").join("&")),t.search("imgur")&&t.search(".jpg")===-1&&(a+=".jpg"),a}};
var Pokemon=function(e,o){var i=this;i.id=e,i.name=o,i.types=[],i.weight="",i.height="",i.pokeapiStatus="loading",i.picture="",i.author="",i.permalink="#",i.pogosnapStatus="loading"},Location=function(e,o,i,n,t){var a=this;a.id=e,a.type=o,a.lat=i,a.lng=n,a.name=t,a.icon="img/"+o+".png",a.markerCreated=!1,a.streetViewUrl="",a.setStreetViewUrl=function(){var e="https://maps.googleapis.com/maps/api/streetview?",o={location:a.lat+","+a.lng,size:"300x200",key:"AIzaSyDnmyJXbQ5xflnzlvc1dJetLgJPbNerL-o"};e+="location="+o.location,e+="&size="+o.size,e+="&key="+o.key,a.streetViewUrl=e},a.openInfoWindow=function(){infoWindow.setContent(MapView.fillTemplate(a)),infoWindow.open(map,model.markers[a.id]),model.markers[a.id].setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){model.markers[a.id].setAnimation(null)},1420)},a.setStreetViewUrl()},SpawnLocation=function(e,o,i,n){var t=this;t.id=e,t.type="spawn",t.lat=o,t.lng=i,t.icon="https://pokeapi.co/media/sprites/pokemon/"+n.id+".png",t.name=n.name,t.markerCreated=!1,t.pokemon_id=n.id,t.openInfoWindow=function(){infoWindow.setContent(MapView.fillTemplate(t)),infoWindow.open(map,model.markers[t.id]),model.markers[t.id].setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){model.markers[t.id].setAnimation(null)},1420)},t.updatePokeInfo=function(e){t.name=e.name,t.pokemon_id=e.id,t.icon="https://pokeapi.co/media/sprites/pokemon/"+e.id+".png"}},model={pokemons:[],locations:[],markers:[]};
var MapView={updateMarker:function(i){var o=this;i.markerCreated===!1&&(model.markers[i.id]=new google.maps.Marker({position:{lat:i.lat,lng:i.lng},map:map,icon:i.icon,title:i.name,id:i.id}),model.markers[i.id].addListener("click",function(){infoWindow.setContent(o.fillTemplate(i)),infoWindow.open(map,model.markers[i.id]),model.markers[i.id].setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){model.markers[i.id].setAnimation(null)},1420)}),i.markerCreated=!0)},template:'<div id="loc-%id%"><h3>%name%</h3><p>(%lat%, %lng%)</p><p>Google Street View: </p><img src="%streetview%" alt="%name%"></div>',spawnTemplate:'<div id="loc-%id%"><h3>#%pokemon_id% %name%</h3><p>(%lat%, %lng%)</p>%pogosnapStatus%<div class="pic"%pogosnapHidden%><img src="%picture%" alt="%name%" style="width: 15em; height: 15em; object-fit: cover;"><p>Image Source: <a href="%permalink%">/r/PokemonGoSnap</a><br>Posted by: %author%</p></div>%pokeapiStatus%<div class="bio" %pokeapiHidden%><ul><li>Types: %types%</li><li>Weight: %weight% kg</li><li>Height: %height% m</li></ul></div></div>',fillTemplate:function(i){var o,e=model.pokemons[i.pokemon_id];if("spawn"===i.type)if(o=this.spawnTemplate,o=o.split("%pokemon_id%").join(i.pokemon_id),o=o.split("%picture%").join(e.picture),"ok"===e.pogosnapStatus?(o=o.split("%pogosnapHidden%").join(""),o=o.split("%pogosnapStatus%").join(""),o=o.split("%author%").join(e.author),o=o.split("%permalink%").join(e.permalink)):"noresults"===e.pogosnapStatus?(o=o.split("%pogosnapHidden%").join(" hidden"),o=o.split("%pogosnapStatus%").join("<p>Pokemon does not have a picture</p>")):"loading"===e.pogosnapStatus?(o=o.split("%pogosnapHidden%").join(" hidden"),o=o.split("%pogosnapStatus%").join('<p>Loading picture...</p><br><img src="https://upload.wikimedia.org/wikipedia/commons/d/de/Ajax-loader.gif" "Loading icon">')):(o=o.split("%pogosnapHidden%").join(" hidden"),o=o.split("%pogosnapStatus%").join("<p>Error loading picture from Reddit</p>")),"ok"===e.pokeapiStatus){o=o.split("%pogoapiHidden%").join(""),o=o.split("%pokeapiStatus%").join(""),o=o.split("%weight%").join(e.weight/10),o=o.split("%height%").join(e.height/10);var t=e.types.join(", ");o=o.split("%types%").join(t)}else"loading"===e.pokeapiStatus?(o=o.split("%pokeapiHidden%").join(" hidden"),o=o.split("%pokeapiStatus%").join('<p>Loading stats...</p><br><img src="https://upload.wikimedia.org/wikipedia/commons/d/de/Ajax-loader.gif" "Loading icon">')):(o=o.split("%pokeapiHidden%").join(" hidden"),o=o.split("%pokeapiStatus%").join("<p>Error loading stats from Pokeapi</p>"));else o=this.template,o=o.split("%streetview%").join(i.streetViewUrl);return o=o.split("%id%").join(i.id),o=o.split("%type%").join(i.type),o=o.split("%lat%").join(i.lat),o=o.split("%lng%").join(i.lng),o=o.split("%name%").join(i.name),o=o.split("%icon%").join(i.icon)}};
var ListViewViewModel=function(){var e=this;e.query=ko.observable(""),e.locations=ko.observableArray(),e.filteredLocations=ko.computed(function(){var o=e.query().toLowerCase(),r=[];return e.locations().sort(function(e,o){e.name.toLowerCase(),o.name.toLowerCase();return e.name>o.name?1:e.name<o.name?-1:0}),""===o?(model.markers.forEach(function(e){e.setVisible(!0)}),e.locations()):(model.markers.forEach(function(e){e.setVisible(!1)}),e.locations().forEach(function(e){var a=e.name.toLowerCase();a.search(o)>-1&&(model.markers[e.id].setVisible(!0),r.push(e),console.log(e))}),r)})},listView=new ListViewViewModel;ko.applyBindings(listView),$(document).ready(function(){$(".drawer").drawer()});
var controller={init:function(){var o=this;o.updateGyms(),o.updateSpawns(),o.updatePokeStops()},updateGyms:function(){fb.onChildAdded("gyms",function(o){var e=o.id,t=o.title,n=o.lat,a=o.lng,p=new Location(e,"gym",n,a,t);MapView.updateMarker(p),listView.locations.push(p)})},updatePokeStops:function(){fb.onChildAdded("pokestops",function(o){var e=o.id,t=o.title,n=o.lat,a=o.lng,p=new Location(e,"pokestop",n,a,t);MapView.updateMarker(p),listView.locations.push(p)})},updateSpawns:function(){fb.onChildAdded("spawns",function(o){var e=o.id,t=o.pokemon_id,n=o.pokemon_name,a=o.lat,p=o.lng;model.locations[e]=new SpawnLocation(e,a,p,new Pokemon(t,n)),listView.locations.push(model.locations[e]),void 0===model.pokemons[t]&&(model.pokemons[t]=new Pokemon(t,n),model.locations[e].updatePokeInfo(model.pokemons[t]),MapView.updateMarker(model.locations[e])),"ok"===model.pokemons[t].pogoSnapStatus?(model.locations[e].updatePokeInfo(model.pokemons[t]),MapView.updateMarker(model.locations[e])):pogosnap.getData(model.pokemons[t],function(o){model.pokemons[t].picture=o.picture,model.pokemons[t].permalink=o.permalink,model.pokemons[t].author=o.author,model.pokemons[t].pogosnapStatus=o.status,model.locations[e].updatePokeInfo(model.pokemons[t]),MapView.updateMarker(model.locations[e])}),"ok"===model.pokemons[t].pokeapiStatus?(model.locations[e].updatePokeInfo(model.pokemons[t]),MapView.updateMarker(model.locations[e])):pokeapi.getData(t,function(o){model.pokemons[t].weight=o.weight,model.pokemons[t].height=o.height,model.pokemons[t].pokeapiStatus=o.status,null!==o.types&&o.types.forEach(function(o){model.pokemons[t].types.push(o.type.name)}),model.locations[e].updatePokeInfo(model.pokemons[t]),MapView.updateMarker(model.locations[e])})})}};controller.init();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwaXMuanMiLCJtb2RlbC5qcyIsInZpZXcuanMiLCJsaXN0dmlldy5qcyIsImNvbnRyb2xsZXIuanMiXSwibmFtZXMiOlsiZmIiLCJkYiIsImNvbmZpZyIsImFwaUtleSIsImF1dGhEb21haW4iLCJkYXRhYmFzZVVSTCIsInN0b3JhZ2VCdWNrZXQiLCJzdGFydCIsImZpcmViYXNlIiwiaW5pdGlhbGl6ZUFwcCIsInRoaXMiLCJkYXRhYmFzZSIsIm9uQ2hpbGRBZGRlZCIsInJlZiIsImNiIiwibXlSZWYiLCJvbiIsInNuYXAiLCJkYXRhIiwidmFsIiwicG9rZWFwaSIsInVybFByZWZpeCIsImdldERhdGEiLCJpZCIsInVybCIsIiQiLCJnZXRKU09OIiwic3RhdHVzIiwiZmFpbCIsIm5vRGF0YSIsIndlaWdodCIsImhlaWdodCIsInR5cGVzIiwibWFwIiwiaW5mb1dpbmRvdyIsImluaXRNYXAiLCJnb29nbGUiLCJtYXBzIiwiTWFwIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImNlbnRlciIsImxhdCIsImxuZyIsInpvb20iLCJJbmZvV2luZG93IiwiZ29vZ2xlRXJyb3IiLCJpbm5lckhUTUwiLCJwb2dvc25hcCIsInBhcmFtcyIsInJlc3RyaWN0X3NyIiwibGltaXQiLCJzb3J0IiwicG9rZW1vbiIsInNlbGYiLCJuYW1lIiwibGlzdGluZyIsImNoaWxkcmVuIiwidW5kZWZpbmVkIiwibXlEYXRhIiwicGljdHVyZSIsImZpeFVybCIsImF1dGhvciIsInBlcm1hbGluayIsIm5ld1VybCIsInNlYXJjaCIsInNwbGl0Iiwiam9pbiIsIlBva2Vtb24iLCJwb2tlYXBpU3RhdHVzIiwicG9nb3NuYXBTdGF0dXMiLCJMb2NhdGlvbiIsInR5cGUiLCJpY29uIiwibWFya2VyQ3JlYXRlZCIsInN0cmVldFZpZXdVcmwiLCJzZXRTdHJlZXRWaWV3VXJsIiwibG9jYXRpb24iLCJzaXplIiwia2V5Iiwib3BlbkluZm9XaW5kb3ciLCJzZXRDb250ZW50IiwiTWFwVmlldyIsImZpbGxUZW1wbGF0ZSIsIm9wZW4iLCJtb2RlbCIsIm1hcmtlcnMiLCJzZXRBbmltYXRpb24iLCJBbmltYXRpb24iLCJCT1VOQ0UiLCJzZXRUaW1lb3V0IiwiU3Bhd25Mb2NhdGlvbiIsInBva2Vtb25faWQiLCJ1cGRhdGVQb2tlSW5mbyIsInBva2Vtb25zIiwibG9jYXRpb25zIiwidXBkYXRlTWFya2VyIiwiTWFya2VyIiwicG9zaXRpb24iLCJ0aXRsZSIsImFkZExpc3RlbmVyIiwidGVtcGxhdGUiLCJzcGF3blRlbXBsYXRlIiwiY29udGVudCIsIkxpc3RWaWV3Vmlld01vZGVsIiwicXVlcnkiLCJrbyIsIm9ic2VydmFibGUiLCJvYnNlcnZhYmxlQXJyYXkiLCJmaWx0ZXJlZExvY2F0aW9ucyIsImNvbXB1dGVkIiwiZmlsdGVyIiwidG9Mb3dlckNhc2UiLCJhIiwiYiIsImZvckVhY2giLCJtYXJrZXIiLCJzZXRWaXNpYmxlIiwibG9jIiwicHVzaCIsImNvbnNvbGUiLCJsb2ciLCJsaXN0VmlldyIsImFwcGx5QmluZGluZ3MiLCJyZWFkeSIsImRyYXdlciIsImNvbnRyb2xsZXIiLCJpbml0IiwidXBkYXRlR3ltcyIsInVwZGF0ZVNwYXducyIsInVwZGF0ZVBva2VTdG9wcyIsImxvY2F0aW9uX2lkIiwiZ3ltIiwicG9rZXN0b3AiLCJsb2NfaWQiLCJwb2tlbW9uX25hbWUiLCJwb2dvU25hcFN0YXR1cyIsInBpY0RhdGEiLCJiaW9EYXRhIiwiaSJdLCJtYXBwaW5ncyI6IkFBQ0EsR0FBSUEsS0FDRkMsR0FBSyxLQUNMQyxRQUNFQyxPQUFRLDBDQUNSQyxXQUFZLDZCQUNaQyxZQUFhLG9DQUNiQyxjQUFlLDBCQUVqQkMsTUFBUSxXQUNOQyxTQUFTQyxjQUFjQyxLQUFLUixRQUM1QlEsS0FBS1QsR0FBS08sU0FBU0csWUFFckJDLGFBQWUsU0FBVUMsRUFBS0MsR0FDNUIsR0FBSUMsR0FBUUwsS0FBS1QsR0FBR1ksSUFBSUEsRUFDeEJFLEdBQU1DLEdBQUcsY0FBZSxTQUFVQyxHQUNoQyxHQUFJQyxH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QUtqQixRQUd6QzhCLE1BQU1VLFVBQVV1QyxHQUFRekMsZUFBZVIsTUFBTVMsU0FBU3ZFLElBQ3REMkQsUUFBUWMsYUFBYVgsTUFBTVUsVUFBVXVDLFNBTS9DUixZQUFXQyIsImZpbGUiOiJhbGwubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gRmlyZWJhc2VcclxudmFyIGZiID0ge1xyXG4gIGRiIDogbnVsbCxcclxuICBjb25maWcgOiB7XHJcbiAgICBhcGlLZXk6IFwiQUl6YVN5RDBMaG11bEs2SHJuLW0tZ2ZoajNYRk5VcTJPZ2ZFbXpnXCIsXHJcbiAgICBhdXRoRG9tYWluOiBcInBvZ28tNjM5MzEuZmlyZWJhc2VhcHAuY29tXCIsXHJcbiAgICBkYXRhYmFzZVVSTDogXCJodHRwczovL3BvZ28tNjM5MzEuZmlyZWJhc2Vpby5jb21cIixcclxuICAgIHN0b3JhZ2VCdWNrZXQ6IFwicG9nby02MzkzMS5hcHBzcG90LmNvbVwiLFxyXG4gIH0sXHJcbiAgc3RhcnQgOiBmdW5jdGlvbiAoKSB7XHJcbiAgICBmaXJlYmFzZS5pbml0aWFsaXplQXBwKHRoaXMuY29uZmlnKTtcclxuICAgIHRoaXMuZGIgPSBmaXJlYmFzZS5kYXRhYmFzZSgpO1xyXG4gIH0sXHJcbiAgb25DaGlsZEFkZGVkIDogZnVuY3Rpb24gKHJlZiwgY2IpIHtcclxuICAgIHZhciBteVJlZiA9IHRoaXMuZGIucmVmKHJlZik7XHJcbiAgICBteVJlZi5vbignY2hpbGRfYWRkZWQnLCBmdW5jdGlvbiAoc25hcCkge1xyXG4gICAgICB2YXIgZGF0YSA9IHNuYXAudmFsKCk7XHJcbiAgICAgIGNiKGRhdGEpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59O1xyXG5mYi5zdGFydCgpO1xyXG4vLyBQb2tlYXBpXHJcbnZhciBwb2tlYXBpID0ge1xyXG4gIHVybFByZWZpeCA6ICdodHRwczovL3Bva2VhcGkuY28vYXBpL3YyL3Bva2Vtb24vJyxcclxuICBnZXREYXRhIDogZnVuY3Rpb24gKGlkLCBjYikge1xyXG4gICAgdmFyIHVybCA9IHRoaXMudXJsUHJlZml4ICsgaWQ7XHJcbiAgICB2YXIganF4aHIgPSAkLmdldEpTT04odXJsLCBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICBkYXRhLnN0YXR1cyA9ICdvayc7XHJcbiAgICAgIGNiKGRhdGEpO1xyXG4gICAgfSlcclxuICAgIC5mYWlsKGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIG5vRGF0YSA9IHtcclxuICAgICAgICB3ZWlnaHQ6IG51bGwsXHJcbiAgICAgICAgaGVpZ2h0OiBudWxsLFxyXG4gICAgICAgIHR5cGVzOiBudWxsLFxyXG4gICAgICAgIHN0YXR1czogJ2ZhaWwnXHJcbiAgICAgIH07XHJcbiAgICAgIGNiKG5vRGF0YSk7XHJcbiAgICB9KTtcclxuICB9LFxyXG59O1xyXG4vLyBHb29nbGUgTWFwc1xyXG52YXIgbWFwLCBpbmZvV2luZG93O1xyXG52YXIgaW5pdE1hcCA9IGZ1bmN0aW9uICgpIHtcclxuICBtYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKSwge1xyXG4gICAgY2VudGVyOiB7bGF0OiAxOS43MjU4NjIsIGxuZzogLTE1NS4wNjkwNn0sXHJcbiAgICB6b29tOiAxNlxyXG4gIH0pO1xyXG4gIGluZm9XaW5kb3cgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdygpO1xyXG59O1xyXG52YXIgZ29vZ2xlRXJyb3IgPSBmdW5jdGlvbiAoKSB7XHJcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpLmlubmVySFRNTCA9ICc8aDE+U29ycnksIEdvb2dsZSBNYXBzIGlzIHVuYXZhaWxhYmxlIGF0IHRoZSBtb21lbnQ8L2gxPjxwPlBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuPC9wPic7XHJcbn07XHJcbi8vIFJlZGRpdCAvci9Qb2tlbW9uR29TbmFwXHJcbnZhciBwb2dvc25hcCA9IHtcclxuICB1cmxQcmVmaXggOiAnaHR0cHM6Ly93d3cucmVkZGl0LmNvbS9yL1Bva2Vtb25Hb1NuYXAvc2VhcmNoLmpzb24/JyxcclxuICBwYXJhbXMgOiB7XHJcbiAgICByZXN0cmljdF9zciA6ICd0cnVlJyxcclxuICAgIGxpbWl0IDogJzEnLFxyXG4gICAgc29ydCA6ICd0b3AnXHJcbiAgfSxcclxuICBnZXREYXRhIDogZnVuY3Rpb24gKHBva2Vtb24sIGNiKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgdXJsID0gc2VsZi51cmxQcmVmaXg7XHJcbiAgICB1cmwgKz0gJ3E9JyArIHBva2Vtb24ubmFtZTtcclxuICAgIHVybCArPSAnJnJlc3RyaWN0X3NyPScgKyBzZWxmLnBhcmFtcy5yZXN0cmljdF9zcjtcclxuICAgIHVybCArPSAnJmxpbWl0PScgKyBzZWxmLnBhcmFtcy5saW1pdDtcclxuICAgIHVybCArPSAnJnNvcnQ9JyArIHNlbGYucGFyYW1zLnNvcnQ7XHJcblxyXG4gICAgdmFyIGpxeGhyID0gJC5nZXRKU09OKHVybCwgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgdmFyIGxpc3RpbmcgPSBkYXRhLmRhdGEuY2hpbGRyZW5bMF0uZGF0YTtcclxuICAgICAgaWYgKGxpc3RpbmcgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHZhciBteURhdGEgPSB7XHJcbiAgICAgICAgICBwaWN0dXJlOiBzZWxmLmZpeFVybChsaXN0aW5nLnVybCksXHJcbiAgICAgICAgICBhdXRob3I6IGxpc3RpbmcuYXV0aG9yLFxyXG4gICAgICAgICAgcGVybWFsaW5rOiAnaHR0cHM6Ly93d3cucmVkZGl0LmNvbScgKyBsaXN0aW5nLnBlcm1hbGluayxcclxuICAgICAgICAgIHN0YXR1czogJ29rJ1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgY2IobXlEYXRhKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICB2YXIgbm9EYXRhID0ge1xyXG4gICAgICAgICAgcGljdHVyZTogJyMnLFxyXG4gICAgICAgICAgYXV0aG9yOiAnJyxcclxuICAgICAgICAgIHBlcm1hbGluazogJycsXHJcbiAgICAgICAgICBzdGF0dXM6ICdub3Jlc3VsdHMnXHJcbiAgICAgICAgfTtcclxuICAgICAgICBjYihub0RhdGEpO1xyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gICAgLmZhaWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICB2YXIgbm9EYXRhID0ge1xyXG4gICAgICAgIHBpY3R1cmU6ICcjJyxcclxuICAgICAgICBhdXRob3I6ICcnLFxyXG4gICAgICAgIHBlcm1hbGluazogJycsXHJcbiAgICAgICAgc3RhdHVzOiAnZmFpbCdcclxuICAgICAgfTtcclxuICAgICAgY2Iobm9EYXRhKTtcclxuICAgIH0pO1xyXG4gIH0sXHJcbiAgZml4VXJsIDogZnVuY3Rpb24gKHVybCkge1xyXG4gICAgdmFyIG5ld1VybCA9IHVybDtcclxuICAgIGlmICh1cmwuc2VhcmNoKCdyZWRkaXR1cGxvYWRzJykpIHtcclxuICAgICAgbmV3VXJsID0gdXJsLnNwbGl0KCcmYW1wOycpLmpvaW4oJyYnKTtcclxuICAgIH1cclxuICAgIGlmICh1cmwuc2VhcmNoKCdpbWd1cicpICYmIHVybC5zZWFyY2goJy5qcGcnKSA9PT0gLTEpIHtcclxuICAgICAgbmV3VXJsICs9ICcuanBnJztcclxuICAgIH1cclxuICAgIHJldHVybiBuZXdVcmw7XHJcbiAgfSxcclxufTtcclxuIiwiLy8gUG9rZW1vbiBDbGFzc1xyXG52YXIgUG9rZW1vbiA9IGZ1bmN0aW9uIChpZCwgbmFtZSkge1xyXG4gIHZhciBzZWxmID0gdGhpcztcclxuICBzZWxmLmlkID0gaWQ7XHJcbiAgc2VsZi5uYW1lID0gbmFtZTtcclxuICAvLyBVcGRhdGVkIGZyb20gUG9rZWFwaTpcclxuICBzZWxmLnR5cGVzID0gW107XHJcbiAgc2VsZi53ZWlnaHQgPSAnJztcclxuICBzZWxmLmhlaWdodCA9ICcnO1xyXG4gIHNlbGYucG9rZWFwaVN0YXR1cyA9ICdsb2FkaW5nJztcclxuICAvLyBVcGRhdGVkIGZyb20gL3IvUG9rZW1vbkdvU25hcDpcclxuICBzZWxmLnBpY3R1cmUgPSAnJztcclxuICBzZWxmLmF1dGhvciA9ICcnO1xyXG4gIHNlbGYucGVybWFsaW5rID0gJyMnO1xyXG4gIHNlbGYucG9nb3NuYXBTdGF0dXMgPSAnbG9hZGluZyc7XHJcbn07XHJcbi8vIExvY2F0aW9uIENsYXNzXHJcbnZhciBMb2NhdGlvbiA9IGZ1bmN0aW9uIChpZCwgdHlwZSwgbGF0LCBsbmcsIG5hbWUpIHtcclxuICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgc2VsZi5pZCA9IGlkO1xyXG4gIHNlbGYudHlwZSA9IHR5cGU7IC8vIGd5bSwgcG9rZXN0b3BcclxuICBzZWxmLmxhdCA9IGxhdDtcclxuICBzZWxmLmxuZyA9IGxuZztcclxuICBzZWxmLm5hbWUgPSBuYW1lO1xyXG4gIHNlbGYuaWNvbiA9ICdpbWcvJyArIHR5cGUgKyAnLnBuZyc7XHJcbiAgc2VsZi5tYXJrZXJDcmVhdGVkID0gZmFsc2U7XHJcbiAgc2VsZi5zdHJlZXRWaWV3VXJsID0gJyc7XHJcbiAgc2VsZi5zZXRTdHJlZXRWaWV3VXJsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHVybCA9ICdodHRwczovL21hcHMuZ29vZ2xlYXBpcy5jb20vbWFwcy9hcGkvc3RyZWV0dmlldz8nO1xyXG4gICAgdmFyIHBhcmFtcyA9IHtcclxuICAgICAgbG9jYXRpb24gOiBzZWxmLmxhdCArICcsJyArIHNlbGYubG5nLFxyXG4gICAgICBzaXplIDogJzMwMHgyMDAnLFxyXG4gICAgICBrZXkgOiAnQUl6YVN5RG5teUpYYlE1eGZsbnpsdmMxZEpldExnSlBiTmVyTC1vJ1xyXG4gICAgfTtcclxuICAgIHVybCArPSAnbG9jYXRpb249JyArIHBhcmFtcy5sb2NhdGlvbjtcclxuICAgIHVybCArPSAnJnNpemU9JyArIHBhcmFtcy5zaXplO1xyXG4gICAgdXJsICs9ICcma2V5PScgKyBwYXJhbXMua2V5O1xyXG4gICAgc2VsZi5zdHJlZXRWaWV3VXJsID0gdXJsO1xyXG4gIH07XHJcbiAgc2VsZi5vcGVuSW5mb1dpbmRvdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgIGluZm9XaW5kb3cuc2V0Q29udGVudChNYXBWaWV3LmZpbGxUZW1wbGF0ZShzZWxmKSk7XHJcbiAgICBpbmZvV2luZG93Lm9wZW4obWFwLCBtb2RlbC5tYXJrZXJzW3NlbGYuaWRdKTtcclxuICAgIC8vIEJvdW5jZSB0d2ljZSBvbiBjbGlja1xyXG4gICAgbW9kZWwubWFya2Vyc1tzZWxmLmlkXS5zZXRBbmltYXRpb24oZ29vZ2xlLm1hcHMuQW5pbWF0aW9uLkJPVU5DRSk7XHJcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgbW9kZWwubWFya2Vyc1tzZWxmLmlkXS5zZXRBbmltYXRpb24obnVsbCk7XHJcbiAgICB9LCAxNDIwKTtcclxuICB9O1xyXG4gIHNlbGYuc2V0U3RyZWV0Vmlld1VybCgpO1xyXG59O1xyXG4vLyBTcGF3biBMb2NhdGlvbiBDbGFzc1xyXG52YXIgU3Bhd25Mb2NhdGlvbiA9IGZ1bmN0aW9uIChpZCwgbGF0LCBsbmcsIHBva2Vtb24pIHtcclxuICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgc2VsZi5pZCA9IGlkO1xyXG4gIHNlbGYudHlwZSA9ICdzcGF3bic7XHJcbiAgc2VsZi5sYXQgPSBsYXQ7XHJcbiAgc2VsZi5sbmcgPSBsbmc7XHJcbiAgc2VsZi5pY29uID0gJ2h0dHBzOi8vcG9rZWFwaS5jby9tZWRpYS9zcHJpdGVzL3Bva2Vtb24vJyArIHBva2Vtb24uaWQgKyAnLnBuZyc7XHJcbiAgc2VsZi5uYW1lID0gcG9rZW1vbi5uYW1lO1xyXG4gIHNlbGYubWFya2VyQ3JlYXRlZCA9IGZhbHNlO1xyXG4gIHNlbGYucG9rZW1vbl9pZCA9IHBva2Vtb24uaWQ7XHJcbiAgc2VsZi5vcGVuSW5mb1dpbmRvdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgIGluZm9XaW5kb3cuc2V0Q29udGVudChNYXBWaWV3LmZpbGxUZW1wbGF0ZShzZWxmKSk7XHJcbiAgICBpbmZvV2luZG93Lm9wZW4obWFwLCBtb2RlbC5tYXJrZXJzW3NlbGYuaWRdKTtcclxuICAgIG1vZGVsLm1hcmtlcnNbc2VsZi5pZF0uc2V0QW5pbWF0aW9uKGdvb2dsZS5tYXBzLkFuaW1hdGlvbi5CT1VOQ0UpO1xyXG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgIG1vZGVsLm1hcmtlcnNbc2VsZi5pZF0uc2V0QW5pbWF0aW9uKG51bGwpO1xyXG4gICAgfSwgMTQyMCk7XHJcbiAgfTtcclxuICBzZWxmLnVwZGF0ZVBva2VJbmZvID0gZnVuY3Rpb24gKHBva2Vtb24pIHtcclxuICAgIHNlbGYubmFtZSA9IHBva2Vtb24ubmFtZTtcclxuICAgIHNlbGYucG9rZW1vbl9pZCA9IHBva2Vtb24uaWQ7XHJcbiAgICBzZWxmLmljb24gPSAnaHR0cHM6Ly9wb2tlYXBpLmNvL21lZGlhL3Nwcml0ZXMvcG9rZW1vbi8nICsgcG9rZW1vbi5pZCArICcucG5nJztcclxuICB9O1xyXG59O1xyXG5cclxudmFyIG1vZGVsID0ge1xyXG4gIHBva2Vtb25zIDogW10sXHJcbiAgbG9jYXRpb25zIDogW10sXHJcbiAgbWFya2VycyA6IFtdLFxyXG59O1xyXG4iLCJ2YXIgTWFwVmlldyA9IHtcclxuICB1cGRhdGVNYXJrZXIgOiBmdW5jdGlvbiAobG9jYXRpb24pIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIGlmIChsb2NhdGlvbi5tYXJrZXJDcmVhdGVkID09PSBmYWxzZSkge1xyXG4gICAgICBtb2RlbC5tYXJrZXJzW2xvY2F0aW9uLmlkXSA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xyXG4gICAgICAgIHBvc2l0aW9uOiB7bGF0OiBsb2NhdGlvbi5sYXQsIGxuZzogbG9jYXRpb24ubG5nfSxcclxuICAgICAgICBtYXA6IG1hcCxcclxuICAgICAgICBpY29uOiBsb2NhdGlvbi5pY29uLFxyXG4gICAgICAgIHRpdGxlOiBsb2NhdGlvbi5uYW1lLFxyXG4gICAgICAgIGlkOiBsb2NhdGlvbi5pZFxyXG4gICAgICB9KTtcclxuICAgICAgbW9kZWwubWFya2Vyc1tsb2NhdGlvbi5pZF0uYWRkTGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vIE9wZW4gaW5mb3dpbmRvd1xyXG4gICAgICAgIGluZm9XaW5kb3cuc2V0Q29udGVudChzZWxmLmZpbGxUZW1wbGF0ZShsb2NhdGlvbikpO1xyXG4gICAgICAgIGluZm9XaW5kb3cub3BlbihtYXAsIG1vZGVsLm1hcmtlcnNbbG9jYXRpb24uaWRdKTtcclxuICAgICAgICAvLyBCb3VuY2UgdHdpY2Ugb24gY2xpY2tcclxuICAgICAgICBtb2RlbC5tYXJrZXJzW2xvY2F0aW9uLmlkXS5zZXRBbmltYXRpb24oZ29vZ2xlLm1hcHMuQW5pbWF0aW9uLkJPVU5DRSk7XHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICBtb2RlbC5tYXJrZXJzW2xvY2F0aW9uLmlkXS5zZXRBbmltYXRpb24obnVsbCk7XHJcbiAgICAgICAgfSwgMTQyMCk7XHJcbiAgICAgIH0pO1xyXG4gICAgICBsb2NhdGlvbi5tYXJrZXJDcmVhdGVkID0gdHJ1ZTtcclxuICAgIH1cclxuICB9LFxyXG4gIHRlbXBsYXRlIDpcclxuXHJcbiAgJzxkaXYgaWQ9XCJsb2MtJWlkJVwiPicgK1xyXG4gICAgJzxoMz4lbmFtZSU8L2gzPicgK1xyXG4gICAgJzxwPiglbGF0JSwgJWxuZyUpPC9wPicgK1xyXG4gICAgJzxwPkdvb2dsZSBTdHJlZXQgVmlldzogPC9wPicgK1xyXG4gICAgJzxpbWcgc3JjPVwiJXN0cmVldHZpZXclXCIgYWx0PVwiJW5hbWUlXCI+JyArXHJcbiAgJzwvZGl2PicsXHJcblxyXG4gIHNwYXduVGVtcGxhdGUgOlxyXG5cclxuICAnPGRpdiBpZD1cImxvYy0laWQlXCI+JyArXHJcbiAgICAnPGgzPiMlcG9rZW1vbl9pZCUgJW5hbWUlPC9oMz4nICtcclxuICAgICc8cD4oJWxhdCUsICVsbmclKTwvcD4nICtcclxuICAgICclcG9nb3NuYXBTdGF0dXMlJyArXHJcbiAgICAnPGRpdiBjbGFzcz1cInBpY1wiJXBvZ29zbmFwSGlkZGVuJT4nICtcclxuICAgICAgJzxpbWcgc3JjPVwiJXBpY3R1cmUlXCIgYWx0PVwiJW5hbWUlXCIgc3R5bGU9XCJ3aWR0aDogMTVlbTsgaGVpZ2h0OiAxNWVtOyBvYmplY3QtZml0OiBjb3ZlcjtcIj4nICtcclxuICAgICAgJzxwPicgK1xyXG4gICAgICAgICdJbWFnZSBTb3VyY2U6IDxhIGhyZWY9XCIlcGVybWFsaW5rJVwiPi9yL1Bva2Vtb25Hb1NuYXA8L2E+PGJyPicgK1xyXG4gICAgICAgICdQb3N0ZWQgYnk6ICVhdXRob3IlJyArXHJcbiAgICAgICc8L3A+JyArXHJcbiAgICAnPC9kaXY+JyArXHJcbiAgICAnJXBva2VhcGlTdGF0dXMlJyArXHJcbiAgICAnPGRpdiBjbGFzcz1cImJpb1wiICVwb2tlYXBpSGlkZGVuJT4nICtcclxuICAgICAgJzx1bD4nICtcclxuICAgICAgICAnPGxpPlR5cGVzOiAldHlwZXMlPC9saT4nICtcclxuICAgICAgICAnPGxpPldlaWdodDogJXdlaWdodCUga2c8L2xpPicgK1xyXG4gICAgICAgICc8bGk+SGVpZ2h0OiAlaGVpZ2h0JSBtPC9saT4nICtcclxuICAgICAgJzwvdWw+JyArXHJcbiAgICAnPC9kaXY+JytcclxuICAnPC9kaXY+JyxcclxuXHJcbiAgZmlsbFRlbXBsYXRlIDogZnVuY3Rpb24gKGxvY2F0aW9uKSB7XHJcbiAgICB2YXIgY29udGVudDtcclxuICAgIHZhciBwb2tlbW9uID0gbW9kZWwucG9rZW1vbnNbbG9jYXRpb24ucG9rZW1vbl9pZF07XHJcblxyXG4gICAgLy8gUG9rZW1vbiBzcGVjaWZpYyB0ZW1wbGF0ZSBpdGVtczpcclxuICAgIGlmIChsb2NhdGlvbi50eXBlID09PSAnc3Bhd24nKSB7XHJcbiAgICAgIGNvbnRlbnQgPSB0aGlzLnNwYXduVGVtcGxhdGU7XHJcbiAgICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCclcG9rZW1vbl9pZCUnKS5qb2luKGxvY2F0aW9uLnBva2Vtb25faWQpO1xyXG4gICAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJXBpY3R1cmUlJykuam9pbihwb2tlbW9uLnBpY3R1cmUpO1xyXG5cclxuICAgICAgaWYgKHBva2Vtb24ucG9nb3NuYXBTdGF0dXMgPT09ICdvaycpIHtcclxuICAgICAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJXBvZ29zbmFwSGlkZGVuJScpLmpvaW4oJycpO1xyXG4gICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCclcG9nb3NuYXBTdGF0dXMlJykuam9pbignJyk7XHJcbiAgICAgICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyVhdXRob3IlJykuam9pbihwb2tlbW9uLmF1dGhvcik7XHJcbiAgICAgICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyVwZXJtYWxpbmslJykuam9pbihwb2tlbW9uLnBlcm1hbGluayk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGVsc2UgaWYgKHBva2Vtb24ucG9nb3NuYXBTdGF0dXMgPT09ICdub3Jlc3VsdHMnKSB7XHJcbiAgICAgICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyVwb2dvc25hcEhpZGRlbiUnKS5qb2luKCcgaGlkZGVuJyk7XHJcbiAgICAgICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyVwb2dvc25hcFN0YXR1cyUnKS5qb2luKCc8cD5Qb2tlbW9uIGRvZXMgbm90IGhhdmUgYSBwaWN0dXJlPC9wPicpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBlbHNlIGlmIChwb2tlbW9uLnBvZ29zbmFwU3RhdHVzID09PSAnbG9hZGluZycpIHtcclxuICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCclcG9nb3NuYXBIaWRkZW4lJykuam9pbignIGhpZGRlbicpO1xyXG4gICAgICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyVwb2dvc25hcFN0YXR1cyUnKS5qb2luKCc8cD5Mb2FkaW5nIHBpY3R1cmUuLi48L3A+PGJyPicgK1xyXG4gICAgICAgJzxpbWcgc3JjPVwiaHR0cHM6Ly91cGxvYWQud2lraW1lZGlhLm9yZy93aWtpcGVkaWEvY29tbW9ucy9kL2RlL0FqYXgtbG9hZGVyLmdpZlwiIFwiTG9hZGluZyBpY29uXCI+Jyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCclcG9nb3NuYXBIaWRkZW4lJykuam9pbignIGhpZGRlbicpO1xyXG4gICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCclcG9nb3NuYXBTdGF0dXMlJykuam9pbignPHA+RXJyb3IgbG9hZGluZyBwaWN0dXJlIGZyb20gUmVkZGl0PC9wPicpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZihwb2tlbW9uLnBva2VhcGlTdGF0dXMgPT09ICdvaycpIHtcclxuICAgICAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJXBvZ29hcGlIaWRkZW4lJykuam9pbignJyk7XHJcbiAgICAgICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyVwb2tlYXBpU3RhdHVzJScpLmpvaW4oJycpO1xyXG4gICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCcld2VpZ2h0JScpLmpvaW4ocG9rZW1vbi53ZWlnaHQgLyAxMCk7XHJcbiAgICAgICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyVoZWlnaHQlJykuam9pbihwb2tlbW9uLmhlaWdodCAvIDEwKTtcclxuICAgICAgICB2YXIgdHlwZXMgPSBwb2tlbW9uLnR5cGVzLmpvaW4oJywgJyk7XHJcbiAgICAgICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyV0eXBlcyUnKS5qb2luKHR5cGVzKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZWxzZSBpZiAocG9rZW1vbi5wb2tlYXBpU3RhdHVzID09PSAnbG9hZGluZycpIHtcclxuICAgICAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJXBva2VhcGlIaWRkZW4lJykuam9pbignIGhpZGRlbicpO1xyXG4gICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCclcG9rZWFwaVN0YXR1cyUnKS5qb2luKCc8cD5Mb2FkaW5nIHN0YXRzLi4uPC9wPjxicj4nICtcclxuICAgICAgICAnPGltZyBzcmM9XCJodHRwczovL3VwbG9hZC53aWtpbWVkaWEub3JnL3dpa2lwZWRpYS9jb21tb25zL2QvZGUvQWpheC1sb2FkZXIuZ2lmXCIgXCJMb2FkaW5nIGljb25cIj4nKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyVwb2tlYXBpSGlkZGVuJScpLmpvaW4oJyBoaWRkZW4nKTtcclxuICAgICAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJXBva2VhcGlTdGF0dXMlJykuam9pbignPHA+RXJyb3IgbG9hZGluZyBzdGF0cyBmcm9tIFBva2VhcGk8L3A+Jyk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIEdlbmVyaWMgbG9jYXRpb24gbWFya2VyIHRlbXBsYXRlIGl0ZW1zOlxyXG4gICAgZWxzZSB7XHJcbiAgICAgIGNvbnRlbnQgPSB0aGlzLnRlbXBsYXRlO1xyXG4gICAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJXN0cmVldHZpZXclJykuam9pbihsb2NhdGlvbi5zdHJlZXRWaWV3VXJsKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBUZW1wbGF0ZSBpdGVtcyBmb3IgYWxsIGxvY2F0aW9uczpcclxuICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCclaWQlJykuam9pbihsb2NhdGlvbi5pZCk7XHJcbiAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJXR5cGUlJykuam9pbihsb2NhdGlvbi50eXBlKTtcclxuICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCclbGF0JScpLmpvaW4obG9jYXRpb24ubGF0KTtcclxuICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCclbG5nJScpLmpvaW4obG9jYXRpb24ubG5nKTtcclxuICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCclbmFtZSUnKS5qb2luKGxvY2F0aW9uLm5hbWUpO1xyXG4gICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyVpY29uJScpLmpvaW4obG9jYXRpb24uaWNvbik7XHJcblxyXG4gICAgcmV0dXJuIGNvbnRlbnQ7XHJcbiAgfVxyXG59O1xyXG4iLCJ2YXIgTGlzdFZpZXdWaWV3TW9kZWwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gIHNlbGYucXVlcnkgPSBrby5vYnNlcnZhYmxlKCcnKTtcclxuICBzZWxmLmxvY2F0aW9ucyA9IGtvLm9ic2VydmFibGVBcnJheSgpO1xyXG4gIHNlbGYuZmlsdGVyZWRMb2NhdGlvbnMgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgZmlsdGVyID0gc2VsZi5xdWVyeSgpLnRvTG93ZXJDYXNlKCk7XHJcbiAgICB2YXIgZmlsdGVyZWRMb2NhdGlvbnMgPSBbXTtcclxuICAgIC8vIHNvcnQgc2VsZi5sb2NhdGlvbnNcclxuICAgIHNlbGYubG9jYXRpb25zKCkuc29ydChmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICB2YXIgbmFtZUEgPSBhLm5hbWUudG9Mb3dlckNhc2UoKTtcclxuICAgICAgdmFyIG5hbWVCID0gYi5uYW1lLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgIGlmIChhLm5hbWUgPiBiLm5hbWUpIHtcclxuICAgICAgICByZXR1cm4gMTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoYS5uYW1lIDwgYi5uYW1lKSB7XHJcbiAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiAwO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8vIFJldHVybiBhbGwgbG9jYXRpb25zIGlmIGZpbHRlciBpcyBibGFua1xyXG4gICAgaWYgKGZpbHRlciA9PT0gJycpIHtcclxuICAgICAgLy8gTWFrZSBhbGwgbWFya2VycyB2aXNpYmxlXHJcbiAgICAgIG1vZGVsLm1hcmtlcnMuZm9yRWFjaChmdW5jdGlvbiAobWFya2VyKSB7XHJcbiAgICAgICAgbWFya2VyLnNldFZpc2libGUodHJ1ZSk7XHJcbiAgICAgIH0pO1xyXG4gICAgICByZXR1cm4gc2VsZi5sb2NhdGlvbnMoKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAvLyBIaWRlIGFsbCBtYXJrZXJzXHJcbiAgICAgIG1vZGVsLm1hcmtlcnMuZm9yRWFjaChmdW5jdGlvbiAobWFya2VyKSB7XHJcbiAgICAgICAgbWFya2VyLnNldFZpc2libGUoZmFsc2UpO1xyXG4gICAgICB9KTtcclxuICAgICAgLy8gUHVzaCBsb2NhdGlvbiB0byBmaWx0ZXJlZExvY2F0aW9ucyBhbmRcclxuICAgICAgLy8gTWFrZSBtYXJrZXIgZm9yIGZpbHRlcmVkIGxvY2F0aW9uIHZpc2libGVcclxuICAgICAgc2VsZi5sb2NhdGlvbnMoKS5mb3JFYWNoKGZ1bmN0aW9uIChsb2MpIHtcclxuICAgICAgICB2YXIgbmFtZSA9IGxvYy5uYW1lLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgaWYgKG5hbWUuc2VhcmNoKGZpbHRlcikgPiAtMSkge1xyXG4gICAgICAgICAgbW9kZWwubWFya2Vyc1tsb2MuaWRdLnNldFZpc2libGUodHJ1ZSk7XHJcbiAgICAgICAgICBmaWx0ZXJlZExvY2F0aW9ucy5wdXNoKGxvYyk7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhsb2MpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICAgIHJldHVybiBmaWx0ZXJlZExvY2F0aW9ucztcclxuICAgIH1cclxuICB9KTtcclxufTtcclxudmFyIGxpc3RWaWV3ID0gbmV3IExpc3RWaWV3Vmlld01vZGVsKCk7XHJcbmtvLmFwcGx5QmluZGluZ3MobGlzdFZpZXcpO1xyXG5cclxuLy8gSGFtYnVyZ2VyIE1lbnUgU2V0dXBcclxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XHJcbiAgJCgnLmRyYXdlcicpLmRyYXdlcigpO1xyXG59KTtcclxuIiwidmFyIGNvbnRyb2xsZXIgPSB7XHJcbiAgaW5pdCA6IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYudXBkYXRlR3ltcygpO1xyXG4gICAgc2VsZi51cGRhdGVTcGF3bnMoKTtcclxuICAgIHNlbGYudXBkYXRlUG9rZVN0b3BzKCk7XHJcbiAgfSxcclxuICB1cGRhdGVHeW1zIDogZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgZmIub25DaGlsZEFkZGVkKCdneW1zJywgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgdmFyIGxvY2F0aW9uX2lkID0gZGF0YS5pZDtcclxuICAgICAgdmFyIG5hbWUgPSBkYXRhLnRpdGxlO1xyXG4gICAgICB2YXIgbGF0ID0gZGF0YS5sYXQ7XHJcbiAgICAgIHZhciBsbmcgPSBkYXRhLmxuZztcclxuICAgICAgdmFyIGd5bSA9IG5ldyBMb2NhdGlvbiAobG9jYXRpb25faWQsICdneW0nLCBsYXQsIGxuZywgbmFtZSk7XHJcbiAgICAgIE1hcFZpZXcudXBkYXRlTWFya2VyKGd5bSk7XHJcbiAgICAgIGxpc3RWaWV3LmxvY2F0aW9ucy5wdXNoKGd5bSk7XHJcbiAgICB9KTtcclxuICB9LFxyXG4gIHVwZGF0ZVBva2VTdG9wcyA6IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIGZiLm9uQ2hpbGRBZGRlZCgncG9rZXN0b3BzJywgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgdmFyIGxvY2F0aW9uX2lkID0gZGF0YS5pZDtcclxuICAgICAgdmFyIG5hbWUgPSBkYXRhLnRpdGxlO1xyXG4gICAgICB2YXIgbGF0ID0gZGF0YS5sYXQ7XHJcbiAgICAgIHZhciBsbmcgPSBkYXRhLmxuZztcclxuICAgICAgdmFyIHBva2VzdG9wID0gbmV3IExvY2F0aW9uIChsb2NhdGlvbl9pZCwgJ3Bva2VzdG9wJywgbGF0LCBsbmcsIG5hbWUpO1xyXG4gICAgICBNYXBWaWV3LnVwZGF0ZU1hcmtlcihwb2tlc3RvcCk7XHJcbiAgICAgIGxpc3RWaWV3LmxvY2F0aW9ucy5wdXNoKHBva2VzdG9wKTtcclxuICAgIH0pO1xyXG4gIH0sXHJcbiAgdXBkYXRlU3Bhd25zIDogZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgZmIub25DaGlsZEFkZGVkKCdzcGF3bnMnLCBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICB2YXIgbG9jX2lkID0gZGF0YS5pZDtcclxuICAgICAgdmFyIGlkID0gZGF0YS5wb2tlbW9uX2lkO1xyXG4gICAgICB2YXIgbmFtZSA9IGRhdGEucG9rZW1vbl9uYW1lO1xyXG4gICAgICB2YXIgbGF0ID0gZGF0YS5sYXQ7XHJcbiAgICAgIHZhciBsbmcgPSBkYXRhLmxuZztcclxuXHJcbiAgICAgIG1vZGVsLmxvY2F0aW9uc1tsb2NfaWRdID0gbmV3IFNwYXduTG9jYXRpb24obG9jX2lkLCBsYXQsIGxuZywgbmV3IFBva2Vtb24oaWQsIG5hbWUpKTtcbiAgICAgIGxpc3RWaWV3LmxvY2F0aW9ucy5wdXNoKG1vZGVsLmxvY2F0aW9uc1tsb2NfaWRdKTtcclxuICAgICAgaWYgKG1vZGVsLnBva2Vtb25zW2lkXSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgbW9kZWwucG9rZW1vbnNbaWRdID0gbmV3IFBva2Vtb24oaWQsIG5hbWUpO1xyXG4gICAgICAgIG1vZGVsLmxvY2F0aW9uc1tsb2NfaWRdLnVwZGF0ZVBva2VJbmZvKG1vZGVsLnBva2Vtb25zW2lkXSk7XHJcbiAgICAgICAgTWFwVmlldy51cGRhdGVNYXJrZXIobW9kZWwubG9jYXRpb25zW2xvY19pZF0pO1xyXG5cclxuICAgICAgfVxyXG4gICAgICAvLyBVcGRhdGUgZGF0YSBmcm9tIHBvZ29zbmFwXHJcbiAgICAgIGlmIChtb2RlbC5wb2tlbW9uc1tpZF0ucG9nb1NuYXBTdGF0dXMgPT09ICdvaycpIHtcclxuICAgICAgICBtb2RlbC5sb2NhdGlvbnNbbG9jX2lkXS51cGRhdGVQb2tlSW5mbyhtb2RlbC5wb2tlbW9uc1tpZF0pO1xyXG4gICAgICAgIE1hcFZpZXcudXBkYXRlTWFya2VyKG1vZGVsLmxvY2F0aW9uc1tsb2NfaWRdKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICBwb2dvc25hcC5nZXREYXRhKG1vZGVsLnBva2Vtb25zW2lkXSwgZnVuY3Rpb24gKHBpY0RhdGEpIHtcclxuICAgICAgICAgIG1vZGVsLnBva2Vtb25zW2lkXS5waWN0dXJlID0gcGljRGF0YS5waWN0dXJlO1xyXG4gICAgICAgICAgbW9kZWwucG9rZW1vbnNbaWRdLnBlcm1hbGluayA9IHBpY0RhdGEucGVybWFsaW5rO1xyXG4gICAgICAgICAgbW9kZWwucG9rZW1vbnNbaWRdLmF1dGhvciA9IHBpY0RhdGEuYXV0aG9yO1xyXG4gICAgICAgICAgbW9kZWwucG9rZW1vbnNbaWRdLnBvZ29zbmFwU3RhdHVzID0gcGljRGF0YS5zdGF0dXM7XHJcbiAgICAgICAgICBtb2RlbC5sb2NhdGlvbnNbbG9jX2lkXS51cGRhdGVQb2tlSW5mbyhtb2RlbC5wb2tlbW9uc1tpZF0pO1xyXG4gICAgICAgICAgTWFwVmlldy51cGRhdGVNYXJrZXIobW9kZWwubG9jYXRpb25zW2xvY19pZF0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBVcGRhdGUgZGF0YSBmcm9tIHBva2VhcGlcclxuICAgICAgaWYgKG1vZGVsLnBva2Vtb25zW2lkXS5wb2tlYXBpU3RhdHVzID09PSAnb2snKSB7XHJcbiAgICAgICAgbW9kZWwubG9jYXRpb25zW2xvY19pZF0udXBkYXRlUG9rZUluZm8obW9kZWwucG9rZW1vbnNbaWRdKTtcclxuICAgICAgICBNYXBWaWV3LnVwZGF0ZU1hcmtlcihtb2RlbC5sb2NhdGlvbnNbbG9jX2lkXSk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgcG9rZWFwaS5nZXREYXRhKGlkLCBmdW5jdGlvbiAoYmlvRGF0YSkge1xyXG4gICAgICAgICAgbW9kZWwucG9rZW1vbnNbaWRdLndlaWdodCA9IGJpb0RhdGEud2VpZ2h0O1xyXG4gICAgICAgICAgbW9kZWwucG9rZW1vbnNbaWRdLmhlaWdodCA9IGJpb0RhdGEuaGVpZ2h0O1xyXG4gICAgICAgICAgbW9kZWwucG9rZW1vbnNbaWRdLnBva2VhcGlTdGF0dXMgPSBiaW9EYXRhLnN0YXR1cztcclxuICAgICAgICAgIGlmKGJpb0RhdGEudHlwZXMgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgYmlvRGF0YS50eXBlcy5mb3JFYWNoKGZ1bmN0aW9uIChpKSB7XHJcbiAgICAgICAgICAgICAgbW9kZWwucG9rZW1vbnNbaWRdLnR5cGVzLnB1c2goaS50eXBlLm5hbWUpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIG1vZGVsLmxvY2F0aW9uc1tsb2NfaWRdLnVwZGF0ZVBva2VJbmZvKG1vZGVsLnBva2Vtb25zW2lkXSk7XHJcbiAgICAgICAgICBNYXBWaWV3LnVwZGF0ZU1hcmtlcihtb2RlbC5sb2NhdGlvbnNbbG9jX2lkXSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH0sXHJcbn07XHJcbmNvbnRyb2xsZXIuaW5pdCgpO1xyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
