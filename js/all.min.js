var Pokemon=function(e,i){var t=this;t.id=e,t.name=i,t.types=[],t.weight="",t.height="",t.pokeapiStatus="loading",t.picture="",t.author="",t.permalink="#",t.pogosnapStatus="loading"},Location=function(e,i,t,o,n){var a=this;a.id=e,a.type=i,a.lat=t,a.lng=o,a.name=n,a.icon="img/"+i+".png",a.markerCreated=!1,a.streetViewUrl="",a.setStreetViewUrl=function(){var e="https://maps.googleapis.com/maps/api/streetview?",i={location:a.lat+","+a.lng,size:"300x200",key:"AIzaSyDnmyJXbQ5xflnzlvc1dJetLgJPbNerL-o"};e+="location="+i.location,e+="&size="+i.size,e+="&key="+i.key,a.streetViewUrl=e},a.setStreetViewUrl()},SpawnLocation=function(e,i,t,o){var n=this;n.id=e,n.type="spawn",n.lat=i,n.lng=t,n.icon="https://pokeapi.co/media/sprites/pokemon/"+o.id+".png",n.name=o.name,n.markerCreated=!1,n.pokemon_id=o.id,n.updatePokeInfo=function(e){n.name=e.name,n.pokemon_id=e.id,n.icon="https://pokeapi.co/media/sprites/pokemon/"+e.id+".png"}},model={pokemons:[],locations:[],markers:[],infowindows:[]};
var MapView={updateMarker:function(i){var o=this;console.log("Location",i.name,"marker created:",i.markerCreated),i.markerCreated===!1&&(model.markers[i.id]=new google.maps.Marker({position:{lat:i.lat,lng:i.lng},map:map,icon:i.icon,title:i.name,id:i.id}),model.infowindows[i.id]=new google.maps.InfoWindow,model.markers[i.id].addListener("click",function(){model.infowindows[i.id].open(map,model.markers[i.id]),model.markers[i.id].setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){model.markers[i.id].setAnimation(null)},1420)}),i.markerCreated=!0),model.infowindows[i.id].setContent(o.fillTemplate(i))},template:'<div id="loc-%id%"><h3>%name%</h3><p>(%lat%, %lng%)</p><p>Google Street View: </p><img src="%streetview%" alt="%name%"></div>',spawnTemplate:'<div id="loc-%id%"><h3>#%pokemon_id% %name%</h3><p>(%lat%, %lng%)</p>%pogosnapStatus%<div class="pic"%pogosnapHidden%><img src="%picture%" alt="%name%" style="width: 15em; height: 15em; object-fit: cover;"><p>Image Source: <a href="%permalink%">/r/PokemonGoSnap</a><br>Posted by: %author%</p></div>%pokeapiStatus%<div class="bio" %pokeapiHidden%><ul><li>Types: %types%</li><li>Weight: %weight% kg</li><li>Height: %height% m</li></ul></div></div>',fillTemplate:function(i){var o,e=model.pokemons[i.pokemon_id];if("spawn"===i.type)if(o=this.spawnTemplate,o=o.split("%pokemon_id%").join(i.pokemon_id),o=o.split("%picture%").join(e.picture),"ok"===e.pogosnapStatus?(o=o.split("%pogosnapHidden%").join(""),o=o.split("%pogosnapStatus%").join(""),o=o.split("%author%").join(e.author),o=o.split("%permalink%").join(e.permalink)):"noresults"===e.pogosnapStatus?(o=o.split("%pogosnapHidden%").join(" hidden"),o=o.split("%pogosnapStatus%").join("<p>Pokemon does not have a picture</p>")):"loading"===e.pogosnapStatus?(o=o.split("%pogosnapHidden%").join(" hidden"),o=o.split("%pogosnapStatus%").join('<p>Loading picture...</p><br><img src="https://upload.wikimedia.org/wikipedia/commons/d/de/Ajax-loader.gif" "Loading icon">')):(o=o.split("%pogosnapHidden%").join(" hidden"),o=o.split("%pogosnapStatus%").join("<p>Error loading picture from Reddit</p>")),"ok"===e.pokeapiStatus){o=o.split("%pogoapiHidden%").join(""),o=o.split("%pokeapiStatus%").join(""),o=o.split("%weight%").join(e.weight/10),o=o.split("%height%").join(e.height/10);var t=e.types.join(", ");o=o.split("%types%").join(t)}else"loading"===e.pokeapiStatus?(o=o.split("%pokeapiHidden%").join(" hidden"),o=o.split("%pokeapiStatus%").join('<p>Loading stats...</p><br><img src="https://upload.wikimedia.org/wikipedia/commons/d/de/Ajax-loader.gif" "Loading icon">')):(o=o.split("%pokeapiHidden%").join(" hidden"),o=o.split("%pokeapiStatus%").join("<p>Error loading stats from Pokeapi</p>"));else o=this.template,o=o.split("%streetview%").join(i.streetViewUrl);return o=o.split("%id%").join(i.id),o=o.split("%type%").join(i.type),o=o.split("%lat%").join(i.lat),o=o.split("%lng%").join(i.lng),o=o.split("%name%").join(i.name),o=o.split("%icon%").join(i.icon)}};
var ListViewViewModel=function(){var e=this;e.query=ko.observable(""),e.locations=ko.observableArray(),e.filteredLocations=ko.computed(function(){var o=e.query().toLowerCase(),i=[];return""===o?(model.markers.forEach(function(e){e.setVisible(!0)}),e.locations()):(model.markers.forEach(function(e){e.setVisible(!1)}),e.locations().forEach(function(e){var r=e.name.toLowerCase();r.search(o)>-1&&(model.markers[e.id].setVisible(!0),i.push(e))}),i)})},listView=new ListViewViewModel;ko.applyBindings(listView),$(document).ready(function(){$(".drawer").drawer()});
var controller={init:function(){var o=this;o.updateGyms(),o.updateSpawns(),o.updatePokeStops()},updateGyms:function(){fb.onChildAdded("gyms",function(o){var e=o.id,t=o.title,n=o.lat,a=o.lng,p=new Location(e,"gym",n,a,t);MapView.updateMarker(p),listView.locations.push(p)})},updatePokeStops:function(){fb.onChildAdded("pokestops",function(o){var e=o.id,t=o.title,n=o.lat,a=o.lng,p=new Location(e,"pokestop",n,a,t);MapView.updateMarker(p),listView.locations.push(p)})},updateSpawns:function(){fb.onChildAdded("spawns",function(o){var e=o.id,t=o.pokemon_id,n=o.pokemon_name,a=o.lat,p=o.lng;model.locations[e]=new SpawnLocation(e,a,p,new Pokemon(t,n)),listView.locations.push(model.locations[e]),void 0===model.pokemons[t]&&(model.pokemons[t]=new Pokemon(t,n),model.locations[e].updatePokeInfo(model.pokemons[t]),MapView.updateMarker(model.locations[e])),"ok"===model.pokemons[t].pogoSnapStatus?(model.locations[e].updatePokeInfo(model.pokemons[t]),MapView.updateMarker(model.locations[e])):pogosnap.getData(model.pokemons[t],function(o){model.pokemons[t].picture=o.picture,model.pokemons[t].permalink=o.permalink,model.pokemons[t].author=o.author,model.pokemons[t].pogosnapStatus=o.status,model.locations[e].updatePokeInfo(model.pokemons[t]),MapView.updateMarker(model.locations[e])}),"ok"===model.pokemons[t].pokeapiStatus?(model.locations[e].updatePokeInfo(model.pokemons[t]),MapView.updateMarker(model.locations[e])):pokeapi.getData(t,function(o){model.pokemons[t].weight=o.weight,model.pokemons[t].height=o.height,model.pokemons[t].pokeapiStatus=o.status,null!==o.types&&o.types.forEach(function(o){model.pokemons[t].types.push(o.type.name)}),model.locations[e].updatePokeInfo(model.pokemons[t]),MapView.updateMarker(model.locations[e])})})}};controller.init();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZGVsLmpzIiwidmlldy5qcyIsImxpc3R2aWV3LmpzIiwiY29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJQb2tlbW9uIiwiaWQiLCJuYW1lIiwic2VsZiIsInRoaXMiLCJ0eXBlcyIsIndlaWdodCIsImhlaWdodCIsInBva2VhcGlTdGF0dXMiLCJwaWN0dXJlIiwiYXV0aG9yIiwicGVybWFsaW5rIiwicG9nb3NuYXBTdGF0dXMiLCJMb2NhdGlvbiIsInR5cGUiLCJsYXQiLCJsbmciLCJpY29uIiwibWFya2VyQ3JlYXRlZCIsInN0cmVldFZpZXdVcmwiLCJzZXRTdHJlZXRWaWV3VXJsIiwidXJsIiwicGFyYW1zIiwibG9jYXRpb24iLCJzaXplIiwia2V5IiwiU3Bhd25Mb2NhdGlvbiIsInBva2Vtb24iLCJwb2tlbW9uX2lkIiwidXBkYXRlUG9rZUluZm8iLCJtb2RlbCIsInBva2Vtb25zIiwibG9jYXRpb25zIiwibWFya2VycyIsImluZm93aW5kb3dzIiwiTWFwVmlldyIsInVwZGF0ZU1hcmtlciIsImNvbnNvbGUiLCJsb2ciLCJnb29nbGUiLCJtYXBzIiwiTWFya2VyIiwicG9zaXRpb24iLCJtYXAiLCJ0aXRsZSIsIkluZm9XaW5kb3ciLCJhZGRMaXN0ZW5lciIsIm9wZW4iLCJzZXRBbmltYXRpb24iLCJBbmltYXRpb24iLCJCT1VOQ0UiLCJzZXRUaW1lb3V0Iiwic2V0Q29udGVudCIsImZpbGxUZW1wbGF0ZSIsInRlbXBsYXRlIiwic3Bhd25UZW1wbGF0ZSIsImNvbnRlbnQiLCJzcGxpdCIsImpvaW4iLCJMaXN0Vmlld1ZpZXdNb2RlbCIsInF1ZXJ5Iiwia28iLCJvYnNlcnZhYmxlIiwib2JzZXJ2YWJsZUFycmF5IiwiZmlsdGVyZWRMb2NhdGlvbnMiLCJjb21wdXRlZCIsImZpbHRlciIsInRvTG93ZXJDYXNlIiwiZm9yRWFjaCIsIm1hcmtlciIsInNldFZpc2libGUiLCJsb2MiLCJzZWFyY2giLCJwdXNoIiwibGlzdFZpZXciLCJhcHBseUJpbmRpbmdzIiwiJCIsImRvY3VtZW50IiwicmVhZHkiLCJkcmF3ZXIiLCJjb250cm9sbGVyIiwiaW5pdCIsInVwZGF0ZUd5bXMiLCJ1cGRhdGVTcGF3bnMiLCJ1cGRhdGVQb2tlU3RvcHMiLCJmYiIsIm9uQ2hpbGRBZGRlZCIsImRhdGEiLCJsb2NhdGlvbl9pZCIsImd5bSIsInBva2VzdG9wIiwibG9jX2lkIiwicG9rZW1vbl9uYW1lIiwidW5kZWZpbmVkIiwicG9nb1NuYXBTdGF0dXMiLCJwb2dvc25hcCIsImdldERhdGEiLCJwaWNEYXRhIiwic3RhdHVzIiwicG9rZWFwaSIsImJpb0RhdGEiLCJpIl0sIm1hcHBpbmdzIjoiQUFDQSxHQUFJQSxTQUFVLFNBQVVDLEVBQUlDLEdBQzFCLEdBQUlDLEdBQU9DLElBQ1hELEdBQUtGLEdBQUtBLEVBQ1ZFLEVBQUtELEtBQU9BLEVBRVpDLEVBQUtFLFNBQ0xGLEVBQUtHLE9BQVMsR0FDZEgsRUFBS0ksT0FBUyxHQUNkSixFQUFLSyxjQUFnQixVQUVyQkwsRUFBS00sUUFBVSxHQUNmTixFQUFLTyxPQUFTLEdBQ2RQLEVBQUtRLFVBQVksSUFDakJSLEVBQUtTLGVBQWlCLFdBR3BCQyxTQUFXLFNBQVVaLEVBQUlhLEVBQU1DLEVBQUtDLEVBQUtkLEdBQzNDLEdBQUlDLEdBQU9DLElBQ1hELEdBQUtGLEdBQUtBLEVBQ1ZFLEVBQUtXLEtBQU9BLEVBQ1pYLEVBQUtZLElBQU1BLEVBQ1haLEVBQUthLElBQU1BLEVBQ1hiLEVBQUtELEtBQU9BLEVBQ1pDLEVBQUtjLEtBQU8sT0FBU0gsRUFBTyxPQUM1QlgsRUFBS2UsZUFBZ0IsRUFDckJmLEVBQUtnQixjQUFnQixHQUNyQmhCLEVBQUtpQixpQkFBbUIsV0FDdEIsR0FBSUMsR0FBTSxtREFDTkMsR0FDRkMsU0FBV3BCLEVBQUtZLElBQU0sSUFBTVosRUFBS2EsSUFDakNRLEtBQU8sVUFDUEMsSUFBTSwwQ0FFUkosSUFBTyxZQUFjQyxFQUFPQyxTQUM1QkYsR0FBTyxTQUFXQyxFQUFPRSxLQUN6QkgsR0FBTyxRQUFVQyxFQUFPRyxJ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QyxRQUFRQyxhQUFhTixNQUFNRSxVQUFVMkQsS0FHckNRLFFBQVFILFFBQVEvRixFQUFJLFNBQVVtRyxHQUM1QnRFLE1BQU1DLFNBQVM5QixHQUFJSyxPQUFTOEYsRUFBUTlGLE9BQ3BDd0IsTUFBTUMsU0FBUzlCLEdBQUlNLE9BQVM2RixFQUFRN0YsT0FDcEN1QixNQUFNQyxTQUFTOUIsR0FBSU8sY0FBZ0I0RixFQUFRRixPQUN0QixPQUFsQkUsRUFBUS9GLE9BQ1QrRixFQUFRL0YsTUFBTStELFFBQVEsU0FBVWlDLEdBQzlCdkUsTUFBTUMsU0FBUzlCLEdBQUlJLE1BQU1vRSxLQUFLNEIsRUFBRXZGLEtBQUtaLFFBR3pDNEIsTUFBTUUsVUFBVTJELEdBQVE5RCxlQUFlQyxNQUFNQyxTQUFTOUIsSUFDdERrQyxRQUFRQyxhQUFhTixNQUFNRSxVQUFVMkQsU0FNL0NYLFlBQVdDIiwiZmlsZSI6ImFsbC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBQb2tlbW9uIENsYXNzXHJcbnZhciBQb2tlbW9uID0gZnVuY3Rpb24gKGlkLCBuYW1lKSB7XHJcbiAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gIHNlbGYuaWQgPSBpZDtcclxuICBzZWxmLm5hbWUgPSBuYW1lO1xyXG4gIC8vIFVwZGF0ZWQgZnJvbSBQb2tlYXBpOlxyXG4gIHNlbGYudHlwZXMgPSBbXTtcclxuICBzZWxmLndlaWdodCA9ICcnO1xyXG4gIHNlbGYuaGVpZ2h0ID0gJyc7XHJcbiAgc2VsZi5wb2tlYXBpU3RhdHVzID0gJ2xvYWRpbmcnO1xyXG4gIC8vIFVwZGF0ZWQgZnJvbSAvci9Qb2tlbW9uR29TbmFwOlxyXG4gIHNlbGYucGljdHVyZSA9ICcnO1xyXG4gIHNlbGYuYXV0aG9yID0gJyc7XHJcbiAgc2VsZi5wZXJtYWxpbmsgPSAnIyc7XHJcbiAgc2VsZi5wb2dvc25hcFN0YXR1cyA9ICdsb2FkaW5nJztcclxufTtcclxuLy8gTG9jYXRpb24gQ2xhc3NcclxudmFyIExvY2F0aW9uID0gZnVuY3Rpb24gKGlkLCB0eXBlLCBsYXQsIGxuZywgbmFtZSkge1xyXG4gIHZhciBzZWxmID0gdGhpcztcclxuICBzZWxmLmlkID0gaWQ7XHJcbiAgc2VsZi50eXBlID0gdHlwZTsgLy8gZ3ltLCBwb2tlc3RvcFxyXG4gIHNlbGYubGF0ID0gbGF0O1xyXG4gIHNlbGYubG5nID0gbG5nO1xyXG4gIHNlbGYubmFtZSA9IG5hbWU7XHJcbiAgc2VsZi5pY29uID0gJ2ltZy8nICsgdHlwZSArICcucG5nJztcclxuICBzZWxmLm1hcmtlckNyZWF0ZWQgPSBmYWxzZTtcclxuICBzZWxmLnN0cmVldFZpZXdVcmwgPSAnJztcclxuICBzZWxmLnNldFN0cmVldFZpZXdVcmwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgdXJsID0gJ2h0dHBzOi8vbWFwcy5nb29nbGVhcGlzLmNvbS9tYXBzL2FwaS9zdHJlZXR2aWV3Pyc7XHJcbiAgICB2YXIgcGFyYW1zID0ge1xyXG4gICAgICBsb2NhdGlvbiA6IHNlbGYubGF0ICsgJywnICsgc2VsZi5sbmcsXHJcbiAgICAgIHNpemUgOiAnMzAweDIwMCcsXHJcbiAgICAgIGtleSA6ICdBSXphU3lEbm15SlhiUTV4Zmxuemx2YzFkSmV0TGdKUGJOZXJMLW8nXHJcbiAgICB9O1xyXG4gICAgdXJsICs9ICdsb2NhdGlvbj0nICsgcGFyYW1zLmxvY2F0aW9uO1xyXG4gICAgdXJsICs9ICcmc2l6ZT0nICsgcGFyYW1zLnNpemU7XHJcbiAgICB1cmwgKz0gJyZrZXk9JyArIHBhcmFtcy5rZXk7XHJcbiAgICBzZWxmLnN0cmVldFZpZXdVcmwgPSB1cmw7XHJcbiAgfTtcclxuICBzZWxmLnNldFN0cmVldFZpZXdVcmwoKTtcclxufTtcclxuLy8gU3Bhd24gTG9jYXRpb24gQ2xhc3NcclxudmFyIFNwYXduTG9jYXRpb24gPSBmdW5jdGlvbiAoaWQsIGxhdCwgbG5nLCBwb2tlbW9uKSB7XHJcbiAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gIHNlbGYuaWQgPSBpZDtcclxuICBzZWxmLnR5cGUgPSAnc3Bhd24nO1xyXG4gIHNlbGYubGF0ID0gbGF0O1xyXG4gIHNlbGYubG5nID0gbG5nO1xyXG4gIHNlbGYuaWNvbiA9ICdodHRwczovL3Bva2VhcGkuY28vbWVkaWEvc3ByaXRlcy9wb2tlbW9uLycgKyBwb2tlbW9uLmlkICsgJy5wbmcnO1xyXG4gIHNlbGYubmFtZSA9IHBva2Vtb24ubmFtZTtcclxuICBzZWxmLm1hcmtlckNyZWF0ZWQgPSBmYWxzZTtcclxuICBzZWxmLnBva2Vtb25faWQgPSBwb2tlbW9uLmlkO1xyXG4gIHNlbGYudXBkYXRlUG9rZUluZm8gPSBmdW5jdGlvbiAocG9rZW1vbikge1xyXG4gICAgc2VsZi5uYW1lID0gcG9rZW1vbi5uYW1lO1xyXG4gICAgc2VsZi5wb2tlbW9uX2lkID0gcG9rZW1vbi5pZDtcclxuICAgIHNlbGYuaWNvbiA9ICdodHRwczovL3Bva2VhcGkuY28vbWVkaWEvc3ByaXRlcy9wb2tlbW9uLycgKyBwb2tlbW9uLmlkICsgJy5wbmcnO1xyXG4gIH07XHJcbn07XHJcblxyXG52YXIgbW9kZWwgPSB7XHJcbiAgcG9rZW1vbnMgOiBbXSxcclxuICBsb2NhdGlvbnMgOiBbXSxcclxuICBtYXJrZXJzIDogW10sXHJcbiAgaW5mb3dpbmRvd3MgOiBbXVxyXG59O1xyXG5cclxuLy8gLy8gVGVzdGluZyBNb2RlbFxyXG4vLyBtb2RlbC5wb2tlbW9uc1sxXSA9IG5ldyBQb2tlbW9uKDEpO1xyXG4vLyBtb2RlbC5wb2tlbW9uc1sxXS5pZCA9ICcxJztcclxuLy8gbW9kZWwucG9rZW1vbnNbMV0ubmFtZSA9ICdidWxiYXNhdXInO1xyXG4vL1xyXG4vLyB2YXIgc3Bhd24gPSBuZXcgU3Bhd25Mb2NhdGlvbigwLCAwLCBtb2RlbC5wb2tlbW9uc1sxXSk7XHJcbi8vIGNvbnNvbGUubG9nKHNwYXduKTtcclxuIiwidmFyIE1hcFZpZXcgPSB7XHJcbiAgdXBkYXRlTWFya2VyIDogZnVuY3Rpb24gKGxvY2F0aW9uKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBjb25zb2xlLmxvZygnTG9jYXRpb24nLCBsb2NhdGlvbi5uYW1lLCAnbWFya2VyIGNyZWF0ZWQ6JywgbG9jYXRpb24ubWFya2VyQ3JlYXRlZCk7XHJcbiAgICBpZiAobG9jYXRpb24ubWFya2VyQ3JlYXRlZCA9PT0gZmFsc2UpIHtcclxuICAgICAgbW9kZWwubWFya2Vyc1tsb2NhdGlvbi5pZF0gPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcclxuICAgICAgICBwb3NpdGlvbjoge2xhdDogbG9jYXRpb24ubGF0LCBsbmc6IGxvY2F0aW9uLmxuZ30sXHJcbiAgICAgICAgbWFwOiBtYXAsXHJcbiAgICAgICAgaWNvbjogbG9jYXRpb24uaWNvbixcclxuICAgICAgICB0aXRsZTogbG9jYXRpb24ubmFtZSxcclxuICAgICAgICBpZDogbG9jYXRpb24uaWRcclxuICAgICAgfSk7XHJcbiAgICAgIG1vZGVsLmluZm93aW5kb3dzW2xvY2F0aW9uLmlkXSA9IG5ldyBnb29nbGUubWFwcy5JbmZvV2luZG93KCk7XHJcbiAgICAgIG1vZGVsLm1hcmtlcnNbbG9jYXRpb24uaWRdLmFkZExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvLyBPcGVuIGluZm93aW5kb3dcclxuICAgICAgICBtb2RlbC5pbmZvd2luZG93c1tsb2NhdGlvbi5pZF0ub3BlbihtYXAsIG1vZGVsLm1hcmtlcnNbbG9jYXRpb24uaWRdKTtcclxuICAgICAgICAvLyBCb3VuY2UgdHdpY2Ugb24gY2xpY2tcclxuICAgICAgICBtb2RlbC5tYXJrZXJzW2xvY2F0aW9uLmlkXS5zZXRBbmltYXRpb24oZ29vZ2xlLm1hcHMuQW5pbWF0aW9uLkJPVU5DRSk7XHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICBtb2RlbC5tYXJrZXJzW2xvY2F0aW9uLmlkXS5zZXRBbmltYXRpb24obnVsbCk7XHJcbiAgICAgICAgfSwgMTQyMCk7XHJcbiAgICAgIH0pO1xyXG4gICAgICBsb2NhdGlvbi5tYXJrZXJDcmVhdGVkID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIG1vZGVsLmluZm93aW5kb3dzW2xvY2F0aW9uLmlkXS5zZXRDb250ZW50KHNlbGYuZmlsbFRlbXBsYXRlKGxvY2F0aW9uKSk7XHJcbiAgfSxcclxuICB0ZW1wbGF0ZSA6XHJcblxyXG4gICc8ZGl2IGlkPVwibG9jLSVpZCVcIj4nICtcclxuICAgICc8aDM+JW5hbWUlPC9oMz4nICtcclxuICAgICc8cD4oJWxhdCUsICVsbmclKTwvcD4nICtcclxuICAgICc8cD5Hb29nbGUgU3RyZWV0IFZpZXc6IDwvcD4nICtcclxuICAgICc8aW1nIHNyYz1cIiVzdHJlZXR2aWV3JVwiIGFsdD1cIiVuYW1lJVwiPicgK1xyXG4gICc8L2Rpdj4nLFxyXG5cclxuICBzcGF3blRlbXBsYXRlIDpcclxuXHJcbiAgJzxkaXYgaWQ9XCJsb2MtJWlkJVwiPicgK1xyXG4gICAgJzxoMz4jJXBva2Vtb25faWQlICVuYW1lJTwvaDM+JyArXHJcbiAgICAnPHA+KCVsYXQlLCAlbG5nJSk8L3A+JyArXHJcbiAgICAnJXBvZ29zbmFwU3RhdHVzJScgK1xyXG4gICAgJzxkaXYgY2xhc3M9XCJwaWNcIiVwb2dvc25hcEhpZGRlbiU+JyArXHJcbiAgICAgICc8aW1nIHNyYz1cIiVwaWN0dXJlJVwiIGFsdD1cIiVuYW1lJVwiIHN0eWxlPVwid2lkdGg6IDE1ZW07IGhlaWdodDogMTVlbTsgb2JqZWN0LWZpdDogY292ZXI7XCI+JyArXHJcbiAgICAgICc8cD4nICtcclxuICAgICAgICAnSW1hZ2UgU291cmNlOiA8YSBocmVmPVwiJXBlcm1hbGluayVcIj4vci9Qb2tlbW9uR29TbmFwPC9hPjxicj4nICtcclxuICAgICAgICAnUG9zdGVkIGJ5OiAlYXV0aG9yJScgK1xyXG4gICAgICAnPC9wPicgK1xyXG4gICAgJzwvZGl2PicgK1xyXG4gICAgJyVwb2tlYXBpU3RhdHVzJScgK1xyXG4gICAgJzxkaXYgY2xhc3M9XCJiaW9cIiAlcG9rZWFwaUhpZGRlbiU+JyArXHJcbiAgICAgICc8dWw+JyArXHJcbiAgICAgICAgJzxsaT5UeXBlczogJXR5cGVzJTwvbGk+JyArXHJcbiAgICAgICAgJzxsaT5XZWlnaHQ6ICV3ZWlnaHQlIGtnPC9saT4nICtcclxuICAgICAgICAnPGxpPkhlaWdodDogJWhlaWdodCUgbTwvbGk+JyArXHJcbiAgICAgICc8L3VsPicgK1xyXG4gICAgJzwvZGl2PicrXHJcbiAgJzwvZGl2PicsXHJcblxyXG4gIGZpbGxUZW1wbGF0ZSA6IGZ1bmN0aW9uIChsb2NhdGlvbikge1xyXG4gICAgdmFyIGNvbnRlbnQ7XHJcbiAgICB2YXIgcG9rZW1vbiA9IG1vZGVsLnBva2Vtb25zW2xvY2F0aW9uLnBva2Vtb25faWRdO1xyXG5cclxuICAgIC8vIFBva2Vtb24gc3BlY2lmaWMgdGVtcGxhdGUgaXRlbXM6XHJcbiAgICBpZiAobG9jYXRpb24udHlwZSA9PT0gJ3NwYXduJykge1xyXG4gICAgICBjb250ZW50ID0gdGhpcy5zcGF3blRlbXBsYXRlO1xyXG4gICAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJXBva2Vtb25faWQlJykuam9pbihsb2NhdGlvbi5wb2tlbW9uX2lkKTtcclxuICAgICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyVwaWN0dXJlJScpLmpvaW4ocG9rZW1vbi5waWN0dXJlKTtcclxuXHJcbiAgICAgIGlmIChwb2tlbW9uLnBvZ29zbmFwU3RhdHVzID09PSAnb2snKSB7XHJcbiAgICAgICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyVwb2dvc25hcEhpZGRlbiUnKS5qb2luKCcnKTtcclxuICAgICAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJXBvZ29zbmFwU3RhdHVzJScpLmpvaW4oJycpO1xyXG4gICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCclYXV0aG9yJScpLmpvaW4ocG9rZW1vbi5hdXRob3IpO1xyXG4gICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCclcGVybWFsaW5rJScpLmpvaW4ocG9rZW1vbi5wZXJtYWxpbmspO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBlbHNlIGlmIChwb2tlbW9uLnBvZ29zbmFwU3RhdHVzID09PSAnbm9yZXN1bHRzJykge1xyXG4gICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCclcG9nb3NuYXBIaWRkZW4lJykuam9pbignIGhpZGRlbicpO1xyXG4gICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCclcG9nb3NuYXBTdGF0dXMlJykuam9pbignPHA+UG9rZW1vbiBkb2VzIG5vdCBoYXZlIGEgcGljdHVyZTwvcD4nKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZWxzZSBpZiAocG9rZW1vbi5wb2dvc25hcFN0YXR1cyA9PT0gJ2xvYWRpbmcnKSB7XHJcbiAgICAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJXBvZ29zbmFwSGlkZGVuJScpLmpvaW4oJyBoaWRkZW4nKTtcclxuICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCclcG9nb3NuYXBTdGF0dXMlJykuam9pbignPHA+TG9hZGluZyBwaWN0dXJlLi4uPC9wPjxicj4nICtcclxuICAgICAgICc8aW1nIHNyYz1cImh0dHBzOi8vdXBsb2FkLndpa2ltZWRpYS5vcmcvd2lraXBlZGlhL2NvbW1vbnMvZC9kZS9BamF4LWxvYWRlci5naWZcIiBcIkxvYWRpbmcgaWNvblwiPicpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJXBvZ29zbmFwSGlkZGVuJScpLmpvaW4oJyBoaWRkZW4nKTtcclxuICAgICAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJXBvZ29zbmFwU3RhdHVzJScpLmpvaW4oJzxwPkVycm9yIGxvYWRpbmcgcGljdHVyZSBmcm9tIFJlZGRpdDwvcD4nKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYocG9rZW1vbi5wb2tlYXBpU3RhdHVzID09PSAnb2snKSB7XHJcbiAgICAgICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyVwb2dvYXBpSGlkZGVuJScpLmpvaW4oJycpO1xyXG4gICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCclcG9rZWFwaVN0YXR1cyUnKS5qb2luKCcnKTtcclxuICAgICAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJXdlaWdodCUnKS5qb2luKHBva2Vtb24ud2VpZ2h0IC8gMTApO1xyXG4gICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCclaGVpZ2h0JScpLmpvaW4ocG9rZW1vbi5oZWlnaHQgLyAxMCk7XHJcbiAgICAgICAgdmFyIHR5cGVzID0gcG9rZW1vbi50eXBlcy5qb2luKCcsICcpO1xyXG4gICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCcldHlwZXMlJykuam9pbih0eXBlcyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGVsc2UgaWYgKHBva2Vtb24ucG9rZWFwaVN0YXR1cyA9PT0gJ2xvYWRpbmcnKSB7XHJcbiAgICAgICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyVwb2tlYXBpSGlkZGVuJScpLmpvaW4oJyBoaWRkZW4nKTtcclxuICAgICAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJXBva2VhcGlTdGF0dXMlJykuam9pbignPHA+TG9hZGluZyBzdGF0cy4uLjwvcD48YnI+JyArXHJcbiAgICAgICAgJzxpbWcgc3JjPVwiaHR0cHM6Ly91cGxvYWQud2lraW1lZGlhLm9yZy93aWtpcGVkaWEvY29tbW9ucy9kL2RlL0FqYXgtbG9hZGVyLmdpZlwiIFwiTG9hZGluZyBpY29uXCI+Jyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCclcG9rZWFwaUhpZGRlbiUnKS5qb2luKCcgaGlkZGVuJyk7XHJcbiAgICAgICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyVwb2tlYXBpU3RhdHVzJScpLmpvaW4oJzxwPkVycm9yIGxvYWRpbmcgc3RhdHMgZnJvbSBQb2tlYXBpPC9wPicpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBHZW5lcmljIGxvY2F0aW9uIG1hcmtlciB0ZW1wbGF0ZSBpdGVtczpcclxuICAgIGVsc2Uge1xyXG4gICAgICBjb250ZW50ID0gdGhpcy50ZW1wbGF0ZTtcclxuICAgICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyVzdHJlZXR2aWV3JScpLmpvaW4obG9jYXRpb24uc3RyZWV0Vmlld1VybCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVGVtcGxhdGUgaXRlbXMgZm9yIGFsbCBsb2NhdGlvbnM6XHJcbiAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJWlkJScpLmpvaW4obG9jYXRpb24uaWQpO1xyXG4gICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyV0eXBlJScpLmpvaW4obG9jYXRpb24udHlwZSk7XHJcbiAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJWxhdCUnKS5qb2luKGxvY2F0aW9uLmxhdCk7XHJcbiAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJWxuZyUnKS5qb2luKGxvY2F0aW9uLmxuZyk7XHJcbiAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJW5hbWUlJykuam9pbihsb2NhdGlvbi5uYW1lKTtcclxuICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCclaWNvbiUnKS5qb2luKGxvY2F0aW9uLmljb24pO1xyXG5cclxuICAgIHJldHVybiBjb250ZW50O1xyXG4gIH1cclxufTtcclxuIiwidmFyIExpc3RWaWV3Vmlld01vZGVsID0gZnVuY3Rpb24gKCkge1xyXG4gIHZhciBzZWxmID0gdGhpcztcclxuICBzZWxmLnF1ZXJ5ID0ga28ub2JzZXJ2YWJsZSgnJyk7XHJcbiAgc2VsZi5sb2NhdGlvbnMgPSBrby5vYnNlcnZhYmxlQXJyYXkoKTtcclxuICBzZWxmLmZpbHRlcmVkTG9jYXRpb25zID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGZpbHRlciA9IHNlbGYucXVlcnkoKS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgdmFyIGZpbHRlcmVkTG9jYXRpb25zID0gW107XHJcblxyXG4gICAgaWYgKGZpbHRlciA9PT0gJycpIHtcclxuICAgICAgLy8gTWFrZSBhbGwgbWFya2VycyB2aXNpYmxlXHJcbiAgICAgIG1vZGVsLm1hcmtlcnMuZm9yRWFjaChmdW5jdGlvbiAobWFya2VyKSB7XHJcbiAgICAgICAgbWFya2VyLnNldFZpc2libGUodHJ1ZSk7XHJcbiAgICAgIH0pO1xyXG4gICAgICAvLyBSZXR1cm4gYWxsIGxvY2F0aW9ucyBpZiBmaWx0ZXIgaXMgYmxhbmtcclxuICAgICAgcmV0dXJuIHNlbGYubG9jYXRpb25zKCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgLy8gSGlkZSBhbGwgbWFya2Vyc1xyXG4gICAgICBtb2RlbC5tYXJrZXJzLmZvckVhY2goZnVuY3Rpb24gKG1hcmtlcikge1xyXG4gICAgICAgIG1hcmtlci5zZXRWaXNpYmxlKGZhbHNlKTtcclxuICAgICAgfSk7XHJcbiAgICAgIC8vIFB1c2ggbG9jYXRpb24gdG8gZmlsdGVyZWRMb2NhdGlvbnMgYW5kXHJcbiAgICAgIC8vIE1ha2UgbWFya2VyIGZvciBsb2NhdGlvbiB2aXNpYmxlXHJcbiAgICAgIHNlbGYubG9jYXRpb25zKCkuZm9yRWFjaChmdW5jdGlvbiAobG9jKSB7XHJcbiAgICAgICAgdmFyIG5hbWUgPSBsb2MubmFtZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgIGlmIChuYW1lLnNlYXJjaChmaWx0ZXIpID4gLTEpIHtcclxuICAgICAgICAgIG1vZGVsLm1hcmtlcnNbbG9jLmlkXS5zZXRWaXNpYmxlKHRydWUpO1xyXG4gICAgICAgICAgZmlsdGVyZWRMb2NhdGlvbnMucHVzaChsb2MpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICAgIHJldHVybiBmaWx0ZXJlZExvY2F0aW9ucztcclxuICAgIH1cclxuICB9KTtcclxufTtcclxudmFyIGxpc3RWaWV3ID0gbmV3IExpc3RWaWV3Vmlld01vZGVsKCk7XHJcbmtvLmFwcGx5QmluZGluZ3MobGlzdFZpZXcpO1xyXG5cclxuLy8gSGFtYnVyZ2VyIE1lbnUgU2V0dXBcclxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XHJcbiAgJCgnLmRyYXdlcicpLmRyYXdlcigpO1xyXG59KTtcclxuIiwidmFyIGNvbnRyb2xsZXIgPSB7XHJcbiAgaW5pdCA6IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYudXBkYXRlR3ltcygpO1xyXG4gICAgc2VsZi51cGRhdGVTcGF3bnMoKTtcclxuICAgIHNlbGYudXBkYXRlUG9rZVN0b3BzKCk7XHJcbiAgfSxcclxuICB1cGRhdGVHeW1zIDogZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgZmIub25DaGlsZEFkZGVkKCdneW1zJywgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgdmFyIGxvY2F0aW9uX2lkID0gZGF0YS5pZDtcclxuICAgICAgdmFyIG5hbWUgPSBkYXRhLnRpdGxlO1xyXG4gICAgICB2YXIgbGF0ID0gZGF0YS5sYXQ7XHJcbiAgICAgIHZhciBsbmcgPSBkYXRhLmxuZztcclxuICAgICAgdmFyIGd5bSA9IG5ldyBMb2NhdGlvbiAobG9jYXRpb25faWQsICdneW0nLCBsYXQsIGxuZywgbmFtZSk7XHJcbiAgICAgIE1hcFZpZXcudXBkYXRlTWFya2VyKGd5bSk7XHJcbiAgICAgIGxpc3RWaWV3LmxvY2F0aW9ucy5wdXNoKGd5bSk7XHJcbiAgICB9KTtcclxuICB9LFxyXG4gIHVwZGF0ZVBva2VTdG9wcyA6IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIGZiLm9uQ2hpbGRBZGRlZCgncG9rZXN0b3BzJywgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgdmFyIGxvY2F0aW9uX2lkID0gZGF0YS5pZDtcclxuICAgICAgdmFyIG5hbWUgPSBkYXRhLnRpdGxlO1xyXG4gICAgICB2YXIgbGF0ID0gZGF0YS5sYXQ7XHJcbiAgICAgIHZhciBsbmcgPSBkYXRhLmxuZztcclxuICAgICAgdmFyIHBva2VzdG9wID0gbmV3IExvY2F0aW9uIChsb2NhdGlvbl9pZCwgJ3Bva2VzdG9wJywgbGF0LCBsbmcsIG5hbWUpO1xyXG4gICAgICBNYXBWaWV3LnVwZGF0ZU1hcmtlcihwb2tlc3RvcCk7XHJcbiAgICAgIGxpc3RWaWV3LmxvY2F0aW9ucy5wdXNoKHBva2VzdG9wKTtcclxuICAgIH0pO1xyXG4gIH0sXHJcbiAgdXBkYXRlU3Bhd25zIDogZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgZmIub25DaGlsZEFkZGVkKCdzcGF3bnMnLCBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICB2YXIgbG9jX2lkID0gZGF0YS5pZDtcclxuICAgICAgdmFyIGlkID0gZGF0YS5wb2tlbW9uX2lkO1xyXG4gICAgICB2YXIgbmFtZSA9IGRhdGEucG9rZW1vbl9uYW1lO1xyXG4gICAgICB2YXIgbGF0ID0gZGF0YS5sYXQ7XHJcbiAgICAgIHZhciBsbmcgPSBkYXRhLmxuZztcclxuXHJcbiAgICAgIG1vZGVsLmxvY2F0aW9uc1tsb2NfaWRdID0gbmV3IFNwYXduTG9jYXRpb24obG9jX2lkLCBsYXQsIGxuZywgbmV3IFBva2Vtb24oaWQsIG5hbWUpKTtcbiAgICAgIGxpc3RWaWV3LmxvY2F0aW9ucy5wdXNoKG1vZGVsLmxvY2F0aW9uc1tsb2NfaWRdKTtcclxuICAgICAgaWYgKG1vZGVsLnBva2Vtb25zW2lkXSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgbW9kZWwucG9rZW1vbnNbaWRdID0gbmV3IFBva2Vtb24oaWQsIG5hbWUpO1xyXG4gICAgICAgIG1vZGVsLmxvY2F0aW9uc1tsb2NfaWRdLnVwZGF0ZVBva2VJbmZvKG1vZGVsLnBva2Vtb25zW2lkXSk7XHJcbiAgICAgICAgTWFwVmlldy51cGRhdGVNYXJrZXIobW9kZWwubG9jYXRpb25zW2xvY19pZF0pO1xyXG5cclxuICAgICAgfVxyXG4gICAgICAvLyBVcGRhdGUgZGF0YSBmcm9tIHBvZ29zbmFwXHJcbiAgICAgIGlmIChtb2RlbC5wb2tlbW9uc1tpZF0ucG9nb1NuYXBTdGF0dXMgPT09ICdvaycpIHtcclxuICAgICAgICBtb2RlbC5sb2NhdGlvbnNbbG9jX2lkXS51cGRhdGVQb2tlSW5mbyhtb2RlbC5wb2tlbW9uc1tpZF0pO1xyXG4gICAgICAgIE1hcFZpZXcudXBkYXRlTWFya2VyKG1vZGVsLmxvY2F0aW9uc1tsb2NfaWRdKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICBwb2dvc25hcC5nZXREYXRhKG1vZGVsLnBva2Vtb25zW2lkXSwgZnVuY3Rpb24gKHBpY0RhdGEpIHtcclxuICAgICAgICAgIG1vZGVsLnBva2Vtb25zW2lkXS5waWN0dXJlID0gcGljRGF0YS5waWN0dXJlO1xyXG4gICAgICAgICAgbW9kZWwucG9rZW1vbnNbaWRdLnBlcm1hbGluayA9IHBpY0RhdGEucGVybWFsaW5rO1xyXG4gICAgICAgICAgbW9kZWwucG9rZW1vbnNbaWRdLmF1dGhvciA9IHBpY0RhdGEuYXV0aG9yO1xyXG4gICAgICAgICAgbW9kZWwucG9rZW1vbnNbaWRdLnBvZ29zbmFwU3RhdHVzID0gcGljRGF0YS5zdGF0dXM7XHJcbiAgICAgICAgICBtb2RlbC5sb2NhdGlvbnNbbG9jX2lkXS51cGRhdGVQb2tlSW5mbyhtb2RlbC5wb2tlbW9uc1tpZF0pO1xyXG4gICAgICAgICAgTWFwVmlldy51cGRhdGVNYXJrZXIobW9kZWwubG9jYXRpb25zW2xvY19pZF0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBVcGRhdGUgZGF0YSBmcm9tIHBva2VhcGlcclxuICAgICAgaWYgKG1vZGVsLnBva2Vtb25zW2lkXS5wb2tlYXBpU3RhdHVzID09PSAnb2snKSB7XHJcbiAgICAgICAgbW9kZWwubG9jYXRpb25zW2xvY19pZF0udXBkYXRlUG9rZUluZm8obW9kZWwucG9rZW1vbnNbaWRdKTtcclxuICAgICAgICBNYXBWaWV3LnVwZGF0ZU1hcmtlcihtb2RlbC5sb2NhdGlvbnNbbG9jX2lkXSk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgcG9rZWFwaS5nZXREYXRhKGlkLCBmdW5jdGlvbiAoYmlvRGF0YSkge1xyXG4gICAgICAgICAgbW9kZWwucG9rZW1vbnNbaWRdLndlaWdodCA9IGJpb0RhdGEud2VpZ2h0O1xyXG4gICAgICAgICAgbW9kZWwucG9rZW1vbnNbaWRdLmhlaWdodCA9IGJpb0RhdGEuaGVpZ2h0O1xyXG4gICAgICAgICAgbW9kZWwucG9rZW1vbnNbaWRdLnBva2VhcGlTdGF0dXMgPSBiaW9EYXRhLnN0YXR1cztcclxuICAgICAgICAgIGlmKGJpb0RhdGEudHlwZXMgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgYmlvRGF0YS50eXBlcy5mb3JFYWNoKGZ1bmN0aW9uIChpKSB7XHJcbiAgICAgICAgICAgICAgbW9kZWwucG9rZW1vbnNbaWRdLnR5cGVzLnB1c2goaS50eXBlLm5hbWUpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIG1vZGVsLmxvY2F0aW9uc1tsb2NfaWRdLnVwZGF0ZVBva2VJbmZvKG1vZGVsLnBva2Vtb25zW2lkXSk7XHJcbiAgICAgICAgICBNYXBWaWV3LnVwZGF0ZU1hcmtlcihtb2RlbC5sb2NhdGlvbnNbbG9jX2lkXSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH0sXHJcbn07XHJcbmNvbnRyb2xsZXIuaW5pdCgpO1xyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
