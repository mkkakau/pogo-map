var fb={db:null,config:{apiKey:"AIzaSyD0LhmulK6Hrn-m-gfhj3XFNUq2OgfEmzg",authDomain:"pogo-63931.firebaseapp.com",databaseURL:"https://pogo-63931.firebaseio.com",storageBucket:"pogo-63931.appspot.com"},start:function(){firebase.initializeApp(this.config),this.db=firebase.database()},onChildAdded:function(t,a){var r=this.db.ref(t);r.on("child_added",function(t){var r=t.val();a(r)})}};fb.start();var pokeapi={urlPrefix:"https://pokeapi.co/api/v2/pokemon/",getData:function(t,a){var r=this.urlPrefix+t;$.getJSON(r,function(t){t.status="ok",a(t)}).fail(function(){var t={weight:null,height:null,types:null,status:"fail"};a(t)})}},map,initMap=function(){map=new google.maps.Map(document.getElementById("map"),{center:{lat:19.725862,lng:-155.06906},zoom:16})},pogosnap={urlPrefix:"https://www.reddit.com/r/PokemonGoSnap/search.json?",params:{restrict_sr:"true",limit:"1",sort:"top"},getData:function(t,a){var r=this,i=r.urlPrefix;i+="q="+t.name,i+="&restrict_sr="+r.params.restrict_sr,i+="&limit="+r.params.limit,i+="&sort="+r.params.sort;$.getJSON(i,function(t){var i=t.data.children[0].data;if(void 0!==i){var e={picture:r.fixUrl(i.url),author:i.author,permalink:"https://www.reddit.com"+i.permalink,status:"ok"};a(e)}else{var o={picture:"#",author:"",permalink:"",status:"noresults"};a(o)}}).fail(function(){var t={picture:"#",author:"",permalink:"",status:"fail"};a(t)})},fixUrl:function(t){var a=t;return t.search("reddituploads")&&(a=t.split("&amp;").join("&")),t.search("imgur")&&t.search(".jpg")===-1&&(a+=".jpg"),a}};
var Pokemon=function(e,o){var i=this;i.id=e,i.name=o,i.types=[],i.weight="",i.height="",i.pokeapiStatus="loading",i.picture="",i.author="",i.permalink="#",i.pogosnapStatus="loading"},Location=function(e,o,i,n,t){var a=this;a.id=e,a.type=o,a.lat=i,a.lng=n,a.name=t,a.icon="img/"+o+".png",a.markerCreated=!1,a.streetViewUrl="",a.setStreetViewUrl=function(){var e="https://maps.googleapis.com/maps/api/streetview?",o={location:a.lat+","+a.lng,size:"300x200",key:"AIzaSyDnmyJXbQ5xflnzlvc1dJetLgJPbNerL-o"};e+="location="+o.location,e+="&size="+o.size,e+="&key="+o.key,a.streetViewUrl=e},a.openInfoWindow=function(){model.infowindows[a.id].open(map,model.markers[a.id]),model.markers[a.id].setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){model.markers[a.id].setAnimation(null)},1420)},a.setStreetViewUrl()},SpawnLocation=function(e,o,i,n){var t=this;t.id=e,t.type="spawn",t.lat=o,t.lng=i,t.icon="https://pokeapi.co/media/sprites/pokemon/"+n.id+".png",t.name=n.name,t.markerCreated=!1,t.pokemon_id=n.id,t.openInfoWindow=function(){model.infowindows[t.id].open(map,model.markers[t.id]),model.markers[t.id].setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){model.markers[t.id].setAnimation(null)},1420)},t.updatePokeInfo=function(e){t.name=e.name,t.pokemon_id=e.id,t.icon="https://pokeapi.co/media/sprites/pokemon/"+e.id+".png"}},model={pokemons:[],locations:[],markers:[],infowindows:[]};
var MapView={updateMarker:function(i){var o=this;i.markerCreated===!1&&(model.markers[i.id]=new google.maps.Marker({position:{lat:i.lat,lng:i.lng},map:map,icon:i.icon,title:i.name,id:i.id}),model.infowindows[i.id]=new google.maps.InfoWindow,model.markers[i.id].addListener("click",function(){model.infowindows[i.id].open(map,model.markers[i.id]),model.markers[i.id].setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){model.markers[i.id].setAnimation(null)},1420)}),i.markerCreated=!0),model.infowindows[i.id].setContent(o.fillTemplate(i))},template:'<div id="loc-%id%"><h3>%name%</h3><p>(%lat%, %lng%)</p><p>Google Street View: </p><img src="%streetview%" alt="%name%"></div>',spawnTemplate:'<div id="loc-%id%"><h3>#%pokemon_id% %name%</h3><p>(%lat%, %lng%)</p>%pogosnapStatus%<div class="pic"%pogosnapHidden%><img src="%picture%" alt="%name%" style="width: 15em; height: 15em; object-fit: cover;"><p>Image Source: <a href="%permalink%">/r/PokemonGoSnap</a><br>Posted by: %author%</p></div>%pokeapiStatus%<div class="bio" %pokeapiHidden%><ul><li>Types: %types%</li><li>Weight: %weight% kg</li><li>Height: %height% m</li></ul></div></div>',fillTemplate:function(i){var o,e=model.pokemons[i.pokemon_id];if("spawn"===i.type)if(o=this.spawnTemplate,o=o.split("%pokemon_id%").join(i.pokemon_id),o=o.split("%picture%").join(e.picture),"ok"===e.pogosnapStatus?(o=o.split("%pogosnapHidden%").join(""),o=o.split("%pogosnapStatus%").join(""),o=o.split("%author%").join(e.author),o=o.split("%permalink%").join(e.permalink)):"noresults"===e.pogosnapStatus?(o=o.split("%pogosnapHidden%").join(" hidden"),o=o.split("%pogosnapStatus%").join("<p>Pokemon does not have a picture</p>")):"loading"===e.pogosnapStatus?(o=o.split("%pogosnapHidden%").join(" hidden"),o=o.split("%pogosnapStatus%").join('<p>Loading picture...</p><br><img src="https://upload.wikimedia.org/wikipedia/commons/d/de/Ajax-loader.gif" "Loading icon">')):(o=o.split("%pogosnapHidden%").join(" hidden"),o=o.split("%pogosnapStatus%").join("<p>Error loading picture from Reddit</p>")),"ok"===e.pokeapiStatus){o=o.split("%pogoapiHidden%").join(""),o=o.split("%pokeapiStatus%").join(""),o=o.split("%weight%").join(e.weight/10),o=o.split("%height%").join(e.height/10);var t=e.types.join(", ");o=o.split("%types%").join(t)}else"loading"===e.pokeapiStatus?(o=o.split("%pokeapiHidden%").join(" hidden"),o=o.split("%pokeapiStatus%").join('<p>Loading stats...</p><br><img src="https://upload.wikimedia.org/wikipedia/commons/d/de/Ajax-loader.gif" "Loading icon">')):(o=o.split("%pokeapiHidden%").join(" hidden"),o=o.split("%pokeapiStatus%").join("<p>Error loading stats from Pokeapi</p>"));else o=this.template,o=o.split("%streetview%").join(i.streetViewUrl);return o=o.split("%id%").join(i.id),o=o.split("%type%").join(i.type),o=o.split("%lat%").join(i.lat),o=o.split("%lng%").join(i.lng),o=o.split("%name%").join(i.name),o=o.split("%icon%").join(i.icon)}};
var ListViewViewModel=function(){var e=this;e.query=ko.observable(""),e.locations=ko.observableArray(),e.filteredLocations=ko.computed(function(){var o=e.query().toLowerCase(),r=[];return e.locations().sort(function(e,o){e.name.toLowerCase(),o.name.toLowerCase();return e.name>o.name?1:e.name<o.name?-1:0}),""===o?(model.markers.forEach(function(e){e.setVisible(!0)}),e.locations()):(model.markers.forEach(function(e){e.setVisible(!1)}),e.locations().forEach(function(e){var a=e.name.toLowerCase();a.search(o)>-1&&(model.markers[e.id].setVisible(!0),r.push(e),console.log(e))}),r)})},listView=new ListViewViewModel;ko.applyBindings(listView),$(document).ready(function(){$(".drawer").drawer()});
var controller={init:function(){var o=this;o.updateGyms(),o.updateSpawns(),o.updatePokeStops()},updateGyms:function(){fb.onChildAdded("gyms",function(o){var e=o.id,t=o.title,n=o.lat,a=o.lng,p=new Location(e,"gym",n,a,t);MapView.updateMarker(p),listView.locations.push(p)})},updatePokeStops:function(){fb.onChildAdded("pokestops",function(o){var e=o.id,t=o.title,n=o.lat,a=o.lng,p=new Location(e,"pokestop",n,a,t);MapView.updateMarker(p),listView.locations.push(p)})},updateSpawns:function(){fb.onChildAdded("spawns",function(o){var e=o.id,t=o.pokemon_id,n=o.pokemon_name,a=o.lat,p=o.lng;model.locations[e]=new SpawnLocation(e,a,p,new Pokemon(t,n)),listView.locations.push(model.locations[e]),void 0===model.pokemons[t]&&(model.pokemons[t]=new Pokemon(t,n),model.locations[e].updatePokeInfo(model.pokemons[t]),MapView.updateMarker(model.locations[e])),"ok"===model.pokemons[t].pogoSnapStatus?(model.locations[e].updatePokeInfo(model.pokemons[t]),MapView.updateMarker(model.locations[e])):pogosnap.getData(model.pokemons[t],function(o){model.pokemons[t].picture=o.picture,model.pokemons[t].permalink=o.permalink,model.pokemons[t].author=o.author,model.pokemons[t].pogosnapStatus=o.status,model.locations[e].updatePokeInfo(model.pokemons[t]),MapView.updateMarker(model.locations[e])}),"ok"===model.pokemons[t].pokeapiStatus?(model.locations[e].updatePokeInfo(model.pokemons[t]),MapView.updateMarker(model.locations[e])):pokeapi.getData(t,function(o){model.pokemons[t].weight=o.weight,model.pokemons[t].height=o.height,model.pokemons[t].pokeapiStatus=o.status,null!==o.types&&o.types.forEach(function(o){model.pokemons[t].types.push(o.type.name)}),model.locations[e].updatePokeInfo(model.pokemons[t]),MapView.updateMarker(model.locations[e])})})}};controller.init();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwaXMuanMiLCJtb2RlbC5qcyIsInZpZXcuanMiLCJsaXN0dmlldy5qcyIsImNvbnRyb2xsZXIuanMiXSwibmFtZXMiOlsiZmIiLCJkYiIsImNvbmZpZyIsImFwaUtleSIsImF1dGhEb21haW4iLCJkYXRhYmFzZVVSTCIsInN0b3JhZ2VCdWNrZXQiLCJzdGFydCIsImZpcmViYXNlIiwiaW5pdGlhbGl6ZUFwcCIsInRoaXMiLCJkYXRhYmFzZSIsIm9uQ2hpbGRBZGRlZCIsInJlZiIsImNiIiwibXlSZWYiLCJvbiIsInNuYXAiLCJkYXRhIiwidmFsIiwicG9rZWFwaSIsInVybFByZWZpeCIsImdldERhdGEiLCJpZCIsInVybCIsIiQiLCJnZXRKU09OIiwic3RhdHVzIiwiZmFpbCIsIm5vRGF0YSIsIndlaWdodCIsImhlaWdodCIsInR5cGVzIiwibWFwIiwiaW5pdE1hcCIsImdvb2dsZSIsIm1hcHMiLCJNYXAiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiY2VudGVyIiwibGF0IiwibG5nIiwiem9vbSIsInBvZ29zbmFwIiwicGFyYW1zIiwicmVzdHJpY3Rfc3IiLCJsaW1pdCIsInNvcnQiLCJwb2tlbW9uIiwic2VsZiIsIm5hbWUiLCJsaXN0aW5nIiwiY2hpbGRyZW4iLCJ1bmRlZmluZWQiLCJteURhdGEiLCJwaWN0dXJlIiwiZml4VXJsIiwiYXV0aG9yIiwicGVybWFsaW5rIiwibmV3VXJsIiwic2VhcmNoIiwic3BsaXQiLCJqb2luIiwiUG9rZW1vbiIsInBva2VhcGlTdGF0dXMiLCJwb2dvc25hcFN0YXR1cyIsIkxvY2F0aW9uIiwidHlwZSIsImljb24iLCJtYXJrZXJDcmVhdGVkIiwic3RyZWV0Vmlld1VybCIsInNldFN0cmVldFZpZXdVcmwiLCJsb2NhdGlvbiIsInNpemUiLCJrZXkiLCJvcGVuSW5mb1dpbmRvdyIsIm1vZGVsIiwiaW5mb3dpbmRvd3MiLCJvcGVuIiwibWFya2VycyIsInNldEFuaW1hdGlvbiIsIkFuaW1hdGlvbiIsIkJPVU5DRSIsInNldFRpbWVvdXQiLCJTcGF3bkxvY2F0aW9uIiwicG9rZW1vbl9pZCIsInVwZGF0ZVBva2VJbmZvIiwicG9rZW1vbnMiLCJsb2NhdGlvbnMiLCJNYXBWaWV3IiwidXBkYXRlTWFya2VyIiwiTWFya2VyIiwicG9zaXRpb24iLCJ0aXRsZSIsIkluZm9XaW5kb3ciLCJhZGRMaXN0ZW5lciIsInNldENvbnRlbnQiLCJmaWxsVGVtcGxhdGUiLCJ0ZW1wbGF0ZSIsInNwYXduVGVtcGxhdGUiLCJjb250ZW50IiwiTGlzdFZpZXdWaWV3TW9kZWwiLCJxdWVyeSIsImtvIiwib2JzZXJ2YWJsZSIsIm9ic2VydmFibGVBcnJheSIsImZpbHRlcmVkTG9jYXRpb25zIiwiY29tcHV0ZWQiLCJmaWx0ZXIiLCJ0b0xvd2VyQ2FzZSIsImEiLCJiIiwiZm9yRWFjaCIsIm1hcmtlciIsInNldFZpc2libGUiLCJsb2MiLCJwdXNoIiwiY29uc29sZSIsImxvZyIsImxpc3RWaWV3IiwiYXBwbHlCaW5kaW5ncyIsInJlYWR5IiwiZHJhd2VyIiwiY29udHJvbGxlciIsImluaXQiLCJ1cGRhdGVHeW1zIiwidXBkYXRlU3Bhd25zIiwidXBkYXRlUG9rZVN0b3BzIiwibG9jYXRpb25faWQiLCJneW0iLCJwb2tlc3RvcCIsImxvY19pZCIsInBva2Vtb25fbmFtZSIsInBvZ29TbmFwU3RhdHVzIiwicGljRGF0YSIsImJpb0RhdGEiLCJpIl0sIm1hcHBpbmdzIjoiQUFDQSxHQUFJQSxLQUNGQyxHQUFLLEtBQ0xDLFFBQ0VDLE9BQVEsMENBQ1JDLFdBQVksNkJBQ1pDLFlBQWEsb0NBQ2JDLGNBQWUsMEJBRWpCQyxNQUFRLFdBQ05DLFNBQVNDLGNBQWNDLEtBQUtSLFFBQzVCUSxLQUFLVCxHQUFLTyxTQUFTRyxZQUVyQkMsYUFBZSxTQUFVQyxFQUFLQyxHQUM1QixHQUFJQyxHQUFRTCxLQUFLVCxHQUFHWSxJQUFJQSxFQUN4QkUsR0FBTUMsR0FBRyxjQUFlLFNBQVVDLEdBQ2hDLEdBQUlDLEdBQU9ELEVBQUtFLEtBQ2hCTCxHQUFHSSxN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QUFNVyxTQUFTakUsSUFDdERtRSxRQUFRQyxhQUFhZCxNQUFNWSxVQUFVMkMsU0FNL0NSLFlBQVdDIiwiZmlsZSI6ImFsbC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBGaXJlYmFzZVxyXG52YXIgZmIgPSB7XHJcbiAgZGIgOiBudWxsLFxyXG4gIGNvbmZpZyA6IHtcclxuICAgIGFwaUtleTogXCJBSXphU3lEMExobXVsSzZIcm4tbS1nZmhqM1hGTlVxMk9nZkVtemdcIixcclxuICAgIGF1dGhEb21haW46IFwicG9nby02MzkzMS5maXJlYmFzZWFwcC5jb21cIixcclxuICAgIGRhdGFiYXNlVVJMOiBcImh0dHBzOi8vcG9nby02MzkzMS5maXJlYmFzZWlvLmNvbVwiLFxyXG4gICAgc3RvcmFnZUJ1Y2tldDogXCJwb2dvLTYzOTMxLmFwcHNwb3QuY29tXCIsXHJcbiAgfSxcclxuICBzdGFydCA6IGZ1bmN0aW9uICgpIHtcclxuICAgIGZpcmViYXNlLmluaXRpYWxpemVBcHAodGhpcy5jb25maWcpO1xyXG4gICAgdGhpcy5kYiA9IGZpcmViYXNlLmRhdGFiYXNlKCk7XHJcbiAgfSxcclxuICBvbkNoaWxkQWRkZWQgOiBmdW5jdGlvbiAocmVmLCBjYikge1xyXG4gICAgdmFyIG15UmVmID0gdGhpcy5kYi5yZWYocmVmKTtcclxuICAgIG15UmVmLm9uKCdjaGlsZF9hZGRlZCcsIGZ1bmN0aW9uIChzbmFwKSB7XHJcbiAgICAgIHZhciBkYXRhID0gc25hcC52YWwoKTtcclxuICAgICAgY2IoZGF0YSk7XHJcbiAgICB9KTtcclxuICB9XHJcbn07XHJcbmZiLnN0YXJ0KCk7XHJcbi8vIFBva2VhcGlcclxudmFyIHBva2VhcGkgPSB7XHJcbiAgdXJsUHJlZml4IDogJ2h0dHBzOi8vcG9rZWFwaS5jby9hcGkvdjIvcG9rZW1vbi8nLFxyXG4gIGdldERhdGEgOiBmdW5jdGlvbiAoaWQsIGNiKSB7XHJcbiAgICB2YXIgdXJsID0gdGhpcy51cmxQcmVmaXggKyBpZDtcclxuICAgIHZhciBqcXhociA9ICQuZ2V0SlNPTih1cmwsIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgIGRhdGEuc3RhdHVzID0gJ29rJztcclxuICAgICAgY2IoZGF0YSk7XHJcbiAgICB9KVxyXG4gICAgLmZhaWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICB2YXIgbm9EYXRhID0ge1xyXG4gICAgICAgIHdlaWdodDogbnVsbCxcclxuICAgICAgICBoZWlnaHQ6IG51bGwsXHJcbiAgICAgICAgdHlwZXM6IG51bGwsXHJcbiAgICAgICAgc3RhdHVzOiAnZmFpbCdcclxuICAgICAgfTtcclxuICAgICAgY2Iobm9EYXRhKTtcclxuICAgIH0pO1xyXG4gIH0sXHJcbn07XHJcbi8vIEdvb2dsZSBNYXBzXHJcbnZhciBtYXA7XHJcbnZhciBpbml0TWFwID0gZnVuY3Rpb24gKCkge1xyXG4gIG1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpLCB7XHJcbiAgICBjZW50ZXI6IHtsYXQ6IDE5LjcyNTg2MiwgbG5nOiAtMTU1LjA2OTA2fSxcclxuICAgIHpvb206IDE2XHJcbiAgfSk7XHJcbn07XHJcbi8vIFJlZGRpdCAvci9Qb2tlbW9uR29TbmFwXHJcbnZhciBwb2dvc25hcCA9IHtcclxuICB1cmxQcmVmaXggOiAnaHR0cHM6Ly93d3cucmVkZGl0LmNvbS9yL1Bva2Vtb25Hb1NuYXAvc2VhcmNoLmpzb24/JyxcclxuICBwYXJhbXMgOiB7XHJcbiAgICByZXN0cmljdF9zciA6ICd0cnVlJyxcclxuICAgIGxpbWl0IDogJzEnLFxyXG4gICAgc29ydCA6ICd0b3AnXHJcbiAgfSxcclxuICBnZXREYXRhIDogZnVuY3Rpb24gKHBva2Vtb24sIGNiKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgdXJsID0gc2VsZi51cmxQcmVmaXg7XHJcbiAgICB1cmwgKz0gJ3E9JyArIHBva2Vtb24ubmFtZTtcclxuICAgIHVybCArPSAnJnJlc3RyaWN0X3NyPScgKyBzZWxmLnBhcmFtcy5yZXN0cmljdF9zcjtcclxuICAgIHVybCArPSAnJmxpbWl0PScgKyBzZWxmLnBhcmFtcy5saW1pdDtcclxuICAgIHVybCArPSAnJnNvcnQ9JyArIHNlbGYucGFyYW1zLnNvcnQ7XHJcblxyXG4gICAgdmFyIGpxeGhyID0gJC5nZXRKU09OKHVybCwgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgdmFyIGxpc3RpbmcgPSBkYXRhLmRhdGEuY2hpbGRyZW5bMF0uZGF0YTtcclxuICAgICAgaWYgKGxpc3RpbmcgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHZhciBteURhdGEgPSB7XHJcbiAgICAgICAgICBwaWN0dXJlOiBzZWxmLmZpeFVybChsaXN0aW5nLnVybCksXHJcbiAgICAgICAgICBhdXRob3I6IGxpc3RpbmcuYXV0aG9yLFxyXG4gICAgICAgICAgcGVybWFsaW5rOiAnaHR0cHM6Ly93d3cucmVkZGl0LmNvbScgKyBsaXN0aW5nLnBlcm1hbGluayxcclxuICAgICAgICAgIHN0YXR1czogJ29rJ1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgY2IobXlEYXRhKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICB2YXIgbm9EYXRhID0ge1xyXG4gICAgICAgICAgcGljdHVyZTogJyMnLFxyXG4gICAgICAgICAgYXV0aG9yOiAnJyxcclxuICAgICAgICAgIHBlcm1hbGluazogJycsXHJcbiAgICAgICAgICBzdGF0dXM6ICdub3Jlc3VsdHMnXHJcbiAgICAgICAgfTtcclxuICAgICAgICBjYihub0RhdGEpO1xyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gICAgLmZhaWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICB2YXIgbm9EYXRhID0ge1xyXG4gICAgICAgIHBpY3R1cmU6ICcjJyxcclxuICAgICAgICBhdXRob3I6ICcnLFxyXG4gICAgICAgIHBlcm1hbGluazogJycsXHJcbiAgICAgICAgc3RhdHVzOiAnZmFpbCdcclxuICAgICAgfTtcclxuICAgICAgY2Iobm9EYXRhKTtcclxuICAgIH0pO1xyXG4gIH0sXHJcbiAgZml4VXJsIDogZnVuY3Rpb24gKHVybCkge1xyXG4gICAgdmFyIG5ld1VybCA9IHVybDtcclxuICAgIGlmICh1cmwuc2VhcmNoKCdyZWRkaXR1cGxvYWRzJykpIHtcclxuICAgICAgbmV3VXJsID0gdXJsLnNwbGl0KCcmYW1wOycpLmpvaW4oJyYnKTtcclxuICAgIH1cclxuICAgIGlmICh1cmwuc2VhcmNoKCdpbWd1cicpICYmIHVybC5zZWFyY2goJy5qcGcnKSA9PT0gLTEpIHtcclxuICAgICAgbmV3VXJsICs9ICcuanBnJztcclxuICAgIH1cclxuICAgIHJldHVybiBuZXdVcmw7XHJcbiAgfSxcclxufTtcclxuIiwiLy8gUG9rZW1vbiBDbGFzc1xyXG52YXIgUG9rZW1vbiA9IGZ1bmN0aW9uIChpZCwgbmFtZSkge1xyXG4gIHZhciBzZWxmID0gdGhpcztcclxuICBzZWxmLmlkID0gaWQ7XHJcbiAgc2VsZi5uYW1lID0gbmFtZTtcclxuICAvLyBVcGRhdGVkIGZyb20gUG9rZWFwaTpcclxuICBzZWxmLnR5cGVzID0gW107XHJcbiAgc2VsZi53ZWlnaHQgPSAnJztcclxuICBzZWxmLmhlaWdodCA9ICcnO1xyXG4gIHNlbGYucG9rZWFwaVN0YXR1cyA9ICdsb2FkaW5nJztcclxuICAvLyBVcGRhdGVkIGZyb20gL3IvUG9rZW1vbkdvU25hcDpcclxuICBzZWxmLnBpY3R1cmUgPSAnJztcclxuICBzZWxmLmF1dGhvciA9ICcnO1xyXG4gIHNlbGYucGVybWFsaW5rID0gJyMnO1xyXG4gIHNlbGYucG9nb3NuYXBTdGF0dXMgPSAnbG9hZGluZyc7XHJcbn07XHJcbi8vIExvY2F0aW9uIENsYXNzXHJcbnZhciBMb2NhdGlvbiA9IGZ1bmN0aW9uIChpZCwgdHlwZSwgbGF0LCBsbmcsIG5hbWUpIHtcclxuICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgc2VsZi5pZCA9IGlkO1xyXG4gIHNlbGYudHlwZSA9IHR5cGU7IC8vIGd5bSwgcG9rZXN0b3BcclxuICBzZWxmLmxhdCA9IGxhdDtcclxuICBzZWxmLmxuZyA9IGxuZztcclxuICBzZWxmLm5hbWUgPSBuYW1lO1xyXG4gIHNlbGYuaWNvbiA9ICdpbWcvJyArIHR5cGUgKyAnLnBuZyc7XHJcbiAgc2VsZi5tYXJrZXJDcmVhdGVkID0gZmFsc2U7XHJcbiAgc2VsZi5zdHJlZXRWaWV3VXJsID0gJyc7XHJcbiAgc2VsZi5zZXRTdHJlZXRWaWV3VXJsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHVybCA9ICdodHRwczovL21hcHMuZ29vZ2xlYXBpcy5jb20vbWFwcy9hcGkvc3RyZWV0dmlldz8nO1xyXG4gICAgdmFyIHBhcmFtcyA9IHtcclxuICAgICAgbG9jYXRpb24gOiBzZWxmLmxhdCArICcsJyArIHNlbGYubG5nLFxyXG4gICAgICBzaXplIDogJzMwMHgyMDAnLFxyXG4gICAgICBrZXkgOiAnQUl6YVN5RG5teUpYYlE1eGZsbnpsdmMxZEpldExnSlBiTmVyTC1vJ1xyXG4gICAgfTtcclxuICAgIHVybCArPSAnbG9jYXRpb249JyArIHBhcmFtcy5sb2NhdGlvbjtcclxuICAgIHVybCArPSAnJnNpemU9JyArIHBhcmFtcy5zaXplO1xyXG4gICAgdXJsICs9ICcma2V5PScgKyBwYXJhbXMua2V5O1xyXG4gICAgc2VsZi5zdHJlZXRWaWV3VXJsID0gdXJsO1xyXG4gIH07XHJcbiAgc2VsZi5vcGVuSW5mb1dpbmRvdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgIG1vZGVsLmluZm93aW5kb3dzW3NlbGYuaWRdLm9wZW4obWFwLCBtb2RlbC5tYXJrZXJzW3NlbGYuaWRdKTtcclxuICAgIC8vIEJvdW5jZSB0d2ljZSBvbiBjbGlja1xyXG4gICAgbW9kZWwubWFya2Vyc1tzZWxmLmlkXS5zZXRBbmltYXRpb24oZ29vZ2xlLm1hcHMuQW5pbWF0aW9uLkJPVU5DRSk7XHJcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgbW9kZWwubWFya2Vyc1tzZWxmLmlkXS5zZXRBbmltYXRpb24obnVsbCk7XHJcbiAgICB9LCAxNDIwKTtcclxuICB9O1xyXG4gIHNlbGYuc2V0U3RyZWV0Vmlld1VybCgpO1xyXG59O1xyXG4vLyBTcGF3biBMb2NhdGlvbiBDbGFzc1xyXG52YXIgU3Bhd25Mb2NhdGlvbiA9IGZ1bmN0aW9uIChpZCwgbGF0LCBsbmcsIHBva2Vtb24pIHtcclxuICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgc2VsZi5pZCA9IGlkO1xyXG4gIHNlbGYudHlwZSA9ICdzcGF3bic7XHJcbiAgc2VsZi5sYXQgPSBsYXQ7XHJcbiAgc2VsZi5sbmcgPSBsbmc7XHJcbiAgc2VsZi5pY29uID0gJ2h0dHBzOi8vcG9rZWFwaS5jby9tZWRpYS9zcHJpdGVzL3Bva2Vtb24vJyArIHBva2Vtb24uaWQgKyAnLnBuZyc7XHJcbiAgc2VsZi5uYW1lID0gcG9rZW1vbi5uYW1lO1xyXG4gIHNlbGYubWFya2VyQ3JlYXRlZCA9IGZhbHNlO1xyXG4gIHNlbGYucG9rZW1vbl9pZCA9IHBva2Vtb24uaWQ7XHJcbiAgc2VsZi5vcGVuSW5mb1dpbmRvdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgIG1vZGVsLmluZm93aW5kb3dzW3NlbGYuaWRdLm9wZW4obWFwLCBtb2RlbC5tYXJrZXJzW3NlbGYuaWRdKTtcclxuICAgIG1vZGVsLm1hcmtlcnNbc2VsZi5pZF0uc2V0QW5pbWF0aW9uKGdvb2dsZS5tYXBzLkFuaW1hdGlvbi5CT1VOQ0UpO1xyXG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgIG1vZGVsLm1hcmtlcnNbc2VsZi5pZF0uc2V0QW5pbWF0aW9uKG51bGwpO1xyXG4gICAgfSwgMTQyMCk7XHJcbiAgfTtcclxuICBzZWxmLnVwZGF0ZVBva2VJbmZvID0gZnVuY3Rpb24gKHBva2Vtb24pIHtcclxuICAgIHNlbGYubmFtZSA9IHBva2Vtb24ubmFtZTtcclxuICAgIHNlbGYucG9rZW1vbl9pZCA9IHBva2Vtb24uaWQ7XHJcbiAgICBzZWxmLmljb24gPSAnaHR0cHM6Ly9wb2tlYXBpLmNvL21lZGlhL3Nwcml0ZXMvcG9rZW1vbi8nICsgcG9rZW1vbi5pZCArICcucG5nJztcclxuICB9O1xyXG59O1xyXG5cclxudmFyIG1vZGVsID0ge1xyXG4gIHBva2Vtb25zIDogW10sXHJcbiAgbG9jYXRpb25zIDogW10sXHJcbiAgbWFya2VycyA6IFtdLFxyXG4gIGluZm93aW5kb3dzIDogW11cclxufTtcclxuXHJcbi8vIC8vIFRlc3RpbmcgTW9kZWxcclxuLy8gbW9kZWwucG9rZW1vbnNbMV0gPSBuZXcgUG9rZW1vbigxKTtcclxuLy8gbW9kZWwucG9rZW1vbnNbMV0uaWQgPSAnMSc7XHJcbi8vIG1vZGVsLnBva2Vtb25zWzFdLm5hbWUgPSAnYnVsYmFzYXVyJztcclxuLy9cclxuLy8gdmFyIHNwYXduID0gbmV3IFNwYXduTG9jYXRpb24oMCwgMCwgbW9kZWwucG9rZW1vbnNbMV0pO1xyXG4vLyBjb25zb2xlLmxvZyhzcGF3bik7XHJcbiIsInZhciBNYXBWaWV3ID0ge1xyXG4gIHVwZGF0ZU1hcmtlciA6IGZ1bmN0aW9uIChsb2NhdGlvbikge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgaWYgKGxvY2F0aW9uLm1hcmtlckNyZWF0ZWQgPT09IGZhbHNlKSB7XHJcbiAgICAgIG1vZGVsLm1hcmtlcnNbbG9jYXRpb24uaWRdID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XHJcbiAgICAgICAgcG9zaXRpb246IHtsYXQ6IGxvY2F0aW9uLmxhdCwgbG5nOiBsb2NhdGlvbi5sbmd9LFxyXG4gICAgICAgIG1hcDogbWFwLFxyXG4gICAgICAgIGljb246IGxvY2F0aW9uLmljb24sXHJcbiAgICAgICAgdGl0bGU6IGxvY2F0aW9uLm5hbWUsXHJcbiAgICAgICAgaWQ6IGxvY2F0aW9uLmlkXHJcbiAgICAgIH0pO1xyXG4gICAgICBtb2RlbC5pbmZvd2luZG93c1tsb2NhdGlvbi5pZF0gPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdygpO1xyXG4gICAgICBtb2RlbC5tYXJrZXJzW2xvY2F0aW9uLmlkXS5hZGRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy8gT3BlbiBpbmZvd2luZG93XHJcbiAgICAgICAgbW9kZWwuaW5mb3dpbmRvd3NbbG9jYXRpb24uaWRdLm9wZW4obWFwLCBtb2RlbC5tYXJrZXJzW2xvY2F0aW9uLmlkXSk7XHJcbiAgICAgICAgLy8gQm91bmNlIHR3aWNlIG9uIGNsaWNrXHJcbiAgICAgICAgbW9kZWwubWFya2Vyc1tsb2NhdGlvbi5pZF0uc2V0QW5pbWF0aW9uKGdvb2dsZS5tYXBzLkFuaW1hdGlvbi5CT1VOQ0UpO1xyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgbW9kZWwubWFya2Vyc1tsb2NhdGlvbi5pZF0uc2V0QW5pbWF0aW9uKG51bGwpO1xyXG4gICAgICAgIH0sIDE0MjApO1xyXG4gICAgICB9KTtcclxuICAgICAgbG9jYXRpb24ubWFya2VyQ3JlYXRlZCA9IHRydWU7XHJcbiAgICB9XHJcbiAgICBtb2RlbC5pbmZvd2luZG93c1tsb2NhdGlvbi5pZF0uc2V0Q29udGVudChzZWxmLmZpbGxUZW1wbGF0ZShsb2NhdGlvbikpO1xyXG4gIH0sXHJcbiAgdGVtcGxhdGUgOlxyXG5cclxuICAnPGRpdiBpZD1cImxvYy0laWQlXCI+JyArXHJcbiAgICAnPGgzPiVuYW1lJTwvaDM+JyArXHJcbiAgICAnPHA+KCVsYXQlLCAlbG5nJSk8L3A+JyArXHJcbiAgICAnPHA+R29vZ2xlIFN0cmVldCBWaWV3OiA8L3A+JyArXHJcbiAgICAnPGltZyBzcmM9XCIlc3RyZWV0dmlldyVcIiBhbHQ9XCIlbmFtZSVcIj4nICtcclxuICAnPC9kaXY+JyxcclxuXHJcbiAgc3Bhd25UZW1wbGF0ZSA6XHJcblxyXG4gICc8ZGl2IGlkPVwibG9jLSVpZCVcIj4nICtcclxuICAgICc8aDM+IyVwb2tlbW9uX2lkJSAlbmFtZSU8L2gzPicgK1xyXG4gICAgJzxwPiglbGF0JSwgJWxuZyUpPC9wPicgK1xyXG4gICAgJyVwb2dvc25hcFN0YXR1cyUnICtcclxuICAgICc8ZGl2IGNsYXNzPVwicGljXCIlcG9nb3NuYXBIaWRkZW4lPicgK1xyXG4gICAgICAnPGltZyBzcmM9XCIlcGljdHVyZSVcIiBhbHQ9XCIlbmFtZSVcIiBzdHlsZT1cIndpZHRoOiAxNWVtOyBoZWlnaHQ6IDE1ZW07IG9iamVjdC1maXQ6IGNvdmVyO1wiPicgK1xyXG4gICAgICAnPHA+JyArXHJcbiAgICAgICAgJ0ltYWdlIFNvdXJjZTogPGEgaHJlZj1cIiVwZXJtYWxpbmslXCI+L3IvUG9rZW1vbkdvU25hcDwvYT48YnI+JyArXHJcbiAgICAgICAgJ1Bvc3RlZCBieTogJWF1dGhvciUnICtcclxuICAgICAgJzwvcD4nICtcclxuICAgICc8L2Rpdj4nICtcclxuICAgICclcG9rZWFwaVN0YXR1cyUnICtcclxuICAgICc8ZGl2IGNsYXNzPVwiYmlvXCIgJXBva2VhcGlIaWRkZW4lPicgK1xyXG4gICAgICAnPHVsPicgK1xyXG4gICAgICAgICc8bGk+VHlwZXM6ICV0eXBlcyU8L2xpPicgK1xyXG4gICAgICAgICc8bGk+V2VpZ2h0OiAld2VpZ2h0JSBrZzwvbGk+JyArXHJcbiAgICAgICAgJzxsaT5IZWlnaHQ6ICVoZWlnaHQlIG08L2xpPicgK1xyXG4gICAgICAnPC91bD4nICtcclxuICAgICc8L2Rpdj4nK1xyXG4gICc8L2Rpdj4nLFxyXG5cclxuICBmaWxsVGVtcGxhdGUgOiBmdW5jdGlvbiAobG9jYXRpb24pIHtcclxuICAgIHZhciBjb250ZW50O1xyXG4gICAgdmFyIHBva2Vtb24gPSBtb2RlbC5wb2tlbW9uc1tsb2NhdGlvbi5wb2tlbW9uX2lkXTtcclxuXHJcbiAgICAvLyBQb2tlbW9uIHNwZWNpZmljIHRlbXBsYXRlIGl0ZW1zOlxyXG4gICAgaWYgKGxvY2F0aW9uLnR5cGUgPT09ICdzcGF3bicpIHtcclxuICAgICAgY29udGVudCA9IHRoaXMuc3Bhd25UZW1wbGF0ZTtcclxuICAgICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyVwb2tlbW9uX2lkJScpLmpvaW4obG9jYXRpb24ucG9rZW1vbl9pZCk7XHJcbiAgICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCclcGljdHVyZSUnKS5qb2luKHBva2Vtb24ucGljdHVyZSk7XHJcblxyXG4gICAgICBpZiAocG9rZW1vbi5wb2dvc25hcFN0YXR1cyA9PT0gJ29rJykge1xyXG4gICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCclcG9nb3NuYXBIaWRkZW4lJykuam9pbignJyk7XHJcbiAgICAgICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyVwb2dvc25hcFN0YXR1cyUnKS5qb2luKCcnKTtcclxuICAgICAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJWF1dGhvciUnKS5qb2luKHBva2Vtb24uYXV0aG9yKTtcclxuICAgICAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJXBlcm1hbGluayUnKS5qb2luKHBva2Vtb24ucGVybWFsaW5rKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZWxzZSBpZiAocG9rZW1vbi5wb2dvc25hcFN0YXR1cyA9PT0gJ25vcmVzdWx0cycpIHtcclxuICAgICAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJXBvZ29zbmFwSGlkZGVuJScpLmpvaW4oJyBoaWRkZW4nKTtcclxuICAgICAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJXBvZ29zbmFwU3RhdHVzJScpLmpvaW4oJzxwPlBva2Vtb24gZG9lcyBub3QgaGF2ZSBhIHBpY3R1cmU8L3A+Jyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGVsc2UgaWYgKHBva2Vtb24ucG9nb3NuYXBTdGF0dXMgPT09ICdsb2FkaW5nJykge1xyXG4gICAgICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyVwb2dvc25hcEhpZGRlbiUnKS5qb2luKCcgaGlkZGVuJyk7XHJcbiAgICAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJXBvZ29zbmFwU3RhdHVzJScpLmpvaW4oJzxwPkxvYWRpbmcgcGljdHVyZS4uLjwvcD48YnI+JyArXHJcbiAgICAgICAnPGltZyBzcmM9XCJodHRwczovL3VwbG9hZC53aWtpbWVkaWEub3JnL3dpa2lwZWRpYS9jb21tb25zL2QvZGUvQWpheC1sb2FkZXIuZ2lmXCIgXCJMb2FkaW5nIGljb25cIj4nKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyVwb2dvc25hcEhpZGRlbiUnKS5qb2luKCcgaGlkZGVuJyk7XHJcbiAgICAgICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyVwb2dvc25hcFN0YXR1cyUnKS5qb2luKCc8cD5FcnJvciBsb2FkaW5nIHBpY3R1cmUgZnJvbSBSZWRkaXQ8L3A+Jyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmKHBva2Vtb24ucG9rZWFwaVN0YXR1cyA9PT0gJ29rJykge1xyXG4gICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCclcG9nb2FwaUhpZGRlbiUnKS5qb2luKCcnKTtcclxuICAgICAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJXBva2VhcGlTdGF0dXMlJykuam9pbignJyk7XHJcbiAgICAgICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyV3ZWlnaHQlJykuam9pbihwb2tlbW9uLndlaWdodCAvIDEwKTtcclxuICAgICAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJWhlaWdodCUnKS5qb2luKHBva2Vtb24uaGVpZ2h0IC8gMTApO1xyXG4gICAgICAgIHZhciB0eXBlcyA9IHBva2Vtb24udHlwZXMuam9pbignLCAnKTtcclxuICAgICAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJXR5cGVzJScpLmpvaW4odHlwZXMpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBlbHNlIGlmIChwb2tlbW9uLnBva2VhcGlTdGF0dXMgPT09ICdsb2FkaW5nJykge1xyXG4gICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCclcG9rZWFwaUhpZGRlbiUnKS5qb2luKCcgaGlkZGVuJyk7XHJcbiAgICAgICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyVwb2tlYXBpU3RhdHVzJScpLmpvaW4oJzxwPkxvYWRpbmcgc3RhdHMuLi48L3A+PGJyPicgK1xyXG4gICAgICAgICc8aW1nIHNyYz1cImh0dHBzOi8vdXBsb2FkLndpa2ltZWRpYS5vcmcvd2lraXBlZGlhL2NvbW1vbnMvZC9kZS9BamF4LWxvYWRlci5naWZcIiBcIkxvYWRpbmcgaWNvblwiPicpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJXBva2VhcGlIaWRkZW4lJykuam9pbignIGhpZGRlbicpO1xyXG4gICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCclcG9rZWFwaVN0YXR1cyUnKS5qb2luKCc8cD5FcnJvciBsb2FkaW5nIHN0YXRzIGZyb20gUG9rZWFwaTwvcD4nKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gR2VuZXJpYyBsb2NhdGlvbiBtYXJrZXIgdGVtcGxhdGUgaXRlbXM6XHJcbiAgICBlbHNlIHtcclxuICAgICAgY29udGVudCA9IHRoaXMudGVtcGxhdGU7XHJcbiAgICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCclc3RyZWV0dmlldyUnKS5qb2luKGxvY2F0aW9uLnN0cmVldFZpZXdVcmwpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFRlbXBsYXRlIGl0ZW1zIGZvciBhbGwgbG9jYXRpb25zOlxyXG4gICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyVpZCUnKS5qb2luKGxvY2F0aW9uLmlkKTtcclxuICAgIGNvbnRlbnQgPSBjb250ZW50LnNwbGl0KCcldHlwZSUnKS5qb2luKGxvY2F0aW9uLnR5cGUpO1xyXG4gICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyVsYXQlJykuam9pbihsb2NhdGlvbi5sYXQpO1xyXG4gICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyVsbmclJykuam9pbihsb2NhdGlvbi5sbmcpO1xyXG4gICAgY29udGVudCA9IGNvbnRlbnQuc3BsaXQoJyVuYW1lJScpLmpvaW4obG9jYXRpb24ubmFtZSk7XHJcbiAgICBjb250ZW50ID0gY29udGVudC5zcGxpdCgnJWljb24lJykuam9pbihsb2NhdGlvbi5pY29uKTtcclxuXHJcbiAgICByZXR1cm4gY29udGVudDtcclxuICB9XHJcbn07XHJcbiIsInZhciBMaXN0Vmlld1ZpZXdNb2RlbCA9IGZ1bmN0aW9uICgpIHtcclxuICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgc2VsZi5xdWVyeSA9IGtvLm9ic2VydmFibGUoJycpO1xyXG4gIHNlbGYubG9jYXRpb25zID0ga28ub2JzZXJ2YWJsZUFycmF5KCk7XHJcbiAgc2VsZi5maWx0ZXJlZExvY2F0aW9ucyA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBmaWx0ZXIgPSBzZWxmLnF1ZXJ5KCkudG9Mb3dlckNhc2UoKTtcclxuICAgIHZhciBmaWx0ZXJlZExvY2F0aW9ucyA9IFtdO1xyXG4gICAgLy8gc29ydCBzZWxmLmxvY2F0aW9uc1xyXG4gICAgc2VsZi5sb2NhdGlvbnMoKS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgIHZhciBuYW1lQSA9IGEubmFtZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICB2YXIgbmFtZUIgPSBiLm5hbWUudG9Mb3dlckNhc2UoKTtcclxuICAgICAgaWYgKGEubmFtZSA+IGIubmFtZSkge1xyXG4gICAgICAgIHJldHVybiAxO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChhLm5hbWUgPCBiLm5hbWUpIHtcclxuICAgICAgICByZXR1cm4gLTE7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIDA7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLy8gUmV0dXJuIGFsbCBsb2NhdGlvbnMgaWYgZmlsdGVyIGlzIGJsYW5rXHJcbiAgICBpZiAoZmlsdGVyID09PSAnJykge1xyXG4gICAgICAvLyBNYWtlIGFsbCBtYXJrZXJzIHZpc2libGVcclxuICAgICAgbW9kZWwubWFya2Vycy5mb3JFYWNoKGZ1bmN0aW9uIChtYXJrZXIpIHtcclxuICAgICAgICBtYXJrZXIuc2V0VmlzaWJsZSh0cnVlKTtcclxuICAgICAgfSk7XHJcbiAgICAgIHJldHVybiBzZWxmLmxvY2F0aW9ucygpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIC8vIEhpZGUgYWxsIG1hcmtlcnNcclxuICAgICAgbW9kZWwubWFya2Vycy5mb3JFYWNoKGZ1bmN0aW9uIChtYXJrZXIpIHtcclxuICAgICAgICBtYXJrZXIuc2V0VmlzaWJsZShmYWxzZSk7XHJcbiAgICAgIH0pO1xyXG4gICAgICAvLyBQdXNoIGxvY2F0aW9uIHRvIGZpbHRlcmVkTG9jYXRpb25zIGFuZFxyXG4gICAgICAvLyBNYWtlIG1hcmtlciBmb3IgZmlsdGVyZWQgbG9jYXRpb24gdmlzaWJsZVxyXG4gICAgICBzZWxmLmxvY2F0aW9ucygpLmZvckVhY2goZnVuY3Rpb24gKGxvYykge1xyXG4gICAgICAgIHZhciBuYW1lID0gbG9jLm5hbWUudG9Mb3dlckNhc2UoKTtcclxuICAgICAgICBpZiAobmFtZS5zZWFyY2goZmlsdGVyKSA+IC0xKSB7XHJcbiAgICAgICAgICBtb2RlbC5tYXJrZXJzW2xvYy5pZF0uc2V0VmlzaWJsZSh0cnVlKTtcclxuICAgICAgICAgIGZpbHRlcmVkTG9jYXRpb25zLnB1c2gobG9jKTtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGxvYyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuIGZpbHRlcmVkTG9jYXRpb25zO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59O1xyXG52YXIgbGlzdFZpZXcgPSBuZXcgTGlzdFZpZXdWaWV3TW9kZWwoKTtcclxua28uYXBwbHlCaW5kaW5ncyhsaXN0Vmlldyk7XHJcblxyXG4vLyBIYW1idXJnZXIgTWVudSBTZXR1cFxyXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcclxuICAkKCcuZHJhd2VyJykuZHJhd2VyKCk7XHJcbn0pO1xyXG4iLCJ2YXIgY29udHJvbGxlciA9IHtcclxuICBpbml0IDogZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi51cGRhdGVHeW1zKCk7XHJcbiAgICBzZWxmLnVwZGF0ZVNwYXducygpO1xyXG4gICAgc2VsZi51cGRhdGVQb2tlU3RvcHMoKTtcclxuICB9LFxyXG4gIHVwZGF0ZUd5bXMgOiBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBmYi5vbkNoaWxkQWRkZWQoJ2d5bXMnLCBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICB2YXIgbG9jYXRpb25faWQgPSBkYXRhLmlkO1xyXG4gICAgICB2YXIgbmFtZSA9IGRhdGEudGl0bGU7XHJcbiAgICAgIHZhciBsYXQgPSBkYXRhLmxhdDtcclxuICAgICAgdmFyIGxuZyA9IGRhdGEubG5nO1xyXG4gICAgICB2YXIgZ3ltID0gbmV3IExvY2F0aW9uIChsb2NhdGlvbl9pZCwgJ2d5bScsIGxhdCwgbG5nLCBuYW1lKTtcclxuICAgICAgTWFwVmlldy51cGRhdGVNYXJrZXIoZ3ltKTtcclxuICAgICAgbGlzdFZpZXcubG9jYXRpb25zLnB1c2goZ3ltKTtcclxuICAgIH0pO1xyXG4gIH0sXHJcbiAgdXBkYXRlUG9rZVN0b3BzIDogZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgZmIub25DaGlsZEFkZGVkKCdwb2tlc3RvcHMnLCBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICB2YXIgbG9jYXRpb25faWQgPSBkYXRhLmlkO1xyXG4gICAgICB2YXIgbmFtZSA9IGRhdGEudGl0bGU7XHJcbiAgICAgIHZhciBsYXQgPSBkYXRhLmxhdDtcclxuICAgICAgdmFyIGxuZyA9IGRhdGEubG5nO1xyXG4gICAgICB2YXIgcG9rZXN0b3AgPSBuZXcgTG9jYXRpb24gKGxvY2F0aW9uX2lkLCAncG9rZXN0b3AnLCBsYXQsIGxuZywgbmFtZSk7XHJcbiAgICAgIE1hcFZpZXcudXBkYXRlTWFya2VyKHBva2VzdG9wKTtcclxuICAgICAgbGlzdFZpZXcubG9jYXRpb25zLnB1c2gocG9rZXN0b3ApO1xyXG4gICAgfSk7XHJcbiAgfSxcclxuICB1cGRhdGVTcGF3bnMgOiBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBmYi5vbkNoaWxkQWRkZWQoJ3NwYXducycsIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgIHZhciBsb2NfaWQgPSBkYXRhLmlkO1xyXG4gICAgICB2YXIgaWQgPSBkYXRhLnBva2Vtb25faWQ7XHJcbiAgICAgIHZhciBuYW1lID0gZGF0YS5wb2tlbW9uX25hbWU7XHJcbiAgICAgIHZhciBsYXQgPSBkYXRhLmxhdDtcclxuICAgICAgdmFyIGxuZyA9IGRhdGEubG5nO1xyXG5cclxuICAgICAgbW9kZWwubG9jYXRpb25zW2xvY19pZF0gPSBuZXcgU3Bhd25Mb2NhdGlvbihsb2NfaWQsIGxhdCwgbG5nLCBuZXcgUG9rZW1vbihpZCwgbmFtZSkpO1xuICAgICAgbGlzdFZpZXcubG9jYXRpb25zLnB1c2gobW9kZWwubG9jYXRpb25zW2xvY19pZF0pO1xyXG4gICAgICBpZiAobW9kZWwucG9rZW1vbnNbaWRdID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICBtb2RlbC5wb2tlbW9uc1tpZF0gPSBuZXcgUG9rZW1vbihpZCwgbmFtZSk7XHJcbiAgICAgICAgbW9kZWwubG9jYXRpb25zW2xvY19pZF0udXBkYXRlUG9rZUluZm8obW9kZWwucG9rZW1vbnNbaWRdKTtcclxuICAgICAgICBNYXBWaWV3LnVwZGF0ZU1hcmtlcihtb2RlbC5sb2NhdGlvbnNbbG9jX2lkXSk7XHJcblxyXG4gICAgICB9XHJcbiAgICAgIC8vIFVwZGF0ZSBkYXRhIGZyb20gcG9nb3NuYXBcclxuICAgICAgaWYgKG1vZGVsLnBva2Vtb25zW2lkXS5wb2dvU25hcFN0YXR1cyA9PT0gJ29rJykge1xyXG4gICAgICAgIG1vZGVsLmxvY2F0aW9uc1tsb2NfaWRdLnVwZGF0ZVBva2VJbmZvKG1vZGVsLnBva2Vtb25zW2lkXSk7XHJcbiAgICAgICAgTWFwVmlldy51cGRhdGVNYXJrZXIobW9kZWwubG9jYXRpb25zW2xvY19pZF0pO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIHBvZ29zbmFwLmdldERhdGEobW9kZWwucG9rZW1vbnNbaWRdLCBmdW5jdGlvbiAocGljRGF0YSkge1xyXG4gICAgICAgICAgbW9kZWwucG9rZW1vbnNbaWRdLnBpY3R1cmUgPSBwaWNEYXRhLnBpY3R1cmU7XHJcbiAgICAgICAgICBtb2RlbC5wb2tlbW9uc1tpZF0ucGVybWFsaW5rID0gcGljRGF0YS5wZXJtYWxpbms7XHJcbiAgICAgICAgICBtb2RlbC5wb2tlbW9uc1tpZF0uYXV0aG9yID0gcGljRGF0YS5hdXRob3I7XHJcbiAgICAgICAgICBtb2RlbC5wb2tlbW9uc1tpZF0ucG9nb3NuYXBTdGF0dXMgPSBwaWNEYXRhLnN0YXR1cztcclxuICAgICAgICAgIG1vZGVsLmxvY2F0aW9uc1tsb2NfaWRdLnVwZGF0ZVBva2VJbmZvKG1vZGVsLnBva2Vtb25zW2lkXSk7XHJcbiAgICAgICAgICBNYXBWaWV3LnVwZGF0ZU1hcmtlcihtb2RlbC5sb2NhdGlvbnNbbG9jX2lkXSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIFVwZGF0ZSBkYXRhIGZyb20gcG9rZWFwaVxyXG4gICAgICBpZiAobW9kZWwucG9rZW1vbnNbaWRdLnBva2VhcGlTdGF0dXMgPT09ICdvaycpIHtcclxuICAgICAgICBtb2RlbC5sb2NhdGlvbnNbbG9jX2lkXS51cGRhdGVQb2tlSW5mbyhtb2RlbC5wb2tlbW9uc1tpZF0pO1xyXG4gICAgICAgIE1hcFZpZXcudXBkYXRlTWFya2VyKG1vZGVsLmxvY2F0aW9uc1tsb2NfaWRdKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICBwb2tlYXBpLmdldERhdGEoaWQsIGZ1bmN0aW9uIChiaW9EYXRhKSB7XHJcbiAgICAgICAgICBtb2RlbC5wb2tlbW9uc1tpZF0ud2VpZ2h0ID0gYmlvRGF0YS53ZWlnaHQ7XHJcbiAgICAgICAgICBtb2RlbC5wb2tlbW9uc1tpZF0uaGVpZ2h0ID0gYmlvRGF0YS5oZWlnaHQ7XHJcbiAgICAgICAgICBtb2RlbC5wb2tlbW9uc1tpZF0ucG9rZWFwaVN0YXR1cyA9IGJpb0RhdGEuc3RhdHVzO1xyXG4gICAgICAgICAgaWYoYmlvRGF0YS50eXBlcyAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBiaW9EYXRhLnR5cGVzLmZvckVhY2goZnVuY3Rpb24gKGkpIHtcclxuICAgICAgICAgICAgICBtb2RlbC5wb2tlbW9uc1tpZF0udHlwZXMucHVzaChpLnR5cGUubmFtZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgbW9kZWwubG9jYXRpb25zW2xvY19pZF0udXBkYXRlUG9rZUluZm8obW9kZWwucG9rZW1vbnNbaWRdKTtcclxuICAgICAgICAgIE1hcFZpZXcudXBkYXRlTWFya2VyKG1vZGVsLmxvY2F0aW9uc1tsb2NfaWRdKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfSxcclxufTtcclxuY29udHJvbGxlci5pbml0KCk7XHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
